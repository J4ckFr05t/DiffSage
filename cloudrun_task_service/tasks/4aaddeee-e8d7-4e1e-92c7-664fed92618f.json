{"state": "SUCCESS", "result": {"metadata": {"title": "Fix/intra ck null issue", "author": "jibinge0rge", "state": "closed", "url": "https://github.com/prevalent-ai/sds-client-tp/pull/750"}, "commits": [{"summary": "This pull request modifies the `sds_ei__host__crowdstrike__job_config.json` file to improve the logic for identifying non-disambiguated hosts. Specifically, it adds a check for null or empty `host_name` and `fqdn` fields and removes the `latest_flag` alias from the `colExpr` definition.", "files_changed": [{"file_path": "configs/sds_ei_configs/spark_job_configs/source_models/intrasource_disambiguated_models/sds_ei__host__crowdstrike__job_config.json", "change_type": "modified", "added_lines": ["\"colExpr\": \"CASE WHEN SIZE(host_name) < 1 AND SIZE(fqdn) < 1 THEN 1 WHEN EXISTS( host_name, x -> lower(x) = '*' OR lower(x) LIKE '%iphone%' OR lower(x) LIKE '%androidenterprise%' OR lower(x) LIKE '%androidforwork%' OR lower(x) LIKE '%android%' OR lower(x) LIKE '%ipad%' OR lower(x) LIKE '% ipad %' OR lower(x) LIKE '%acer%' OR lower(x) RLIKE 'macbook' OR lower(x) LIKE '%samsungsm%' OR lower(x) LIKE '%samsungsc%' OR lower(x) LIKE '%samsungsamsung%' OR lower(x) LIKE '%xiaomi%' OR lower(x) LIKE '%huawei%' OR lower(x) LIKE '%motorola%' OR lower(x) LIKE '%oppo%' OR lower(x) LIKE '%googlepixel%' OR lower(x) LIKE '%vodafone%' OR lower(x) LIKE '%oneplus%' OR lower(x) LIKE '%realme%' OR lower(x) LIKE '%honor%' OR lower(x) LIKE '%vivo%' OR lower(x) LIKE '%infinix%' OR lower(x) LIKE '%freescale%' OR lower(x) LIKE '%sony%' OR lower(x) LIKE '%tecno mobile%' OR lower(x) LIKE '%tecno%' OR lower(x) LIKE '%ipod%' OR lower(x) LIKE '%blackberry%' OR lower(x) LIKE '%tecnotecno%' OR lower(x) LIKE '%nokia%' OR lower(x) LIKE '%blackview%' OR lower(x) LIKE '%kornsifero%' OR lower(x) LIKE '%hmd global%' OR lower(x) LIKE '%hmd%' OR lower(x) LIKE '%nubia%' OR lower(x) LIKE '%general mobile%' OR lower(x) LIKE '%reeder%' OR lower(x) LIKE '%microsoft%' OR lower(x) LIKE '%polystudio%' OR lower(x) LIKE '%rockchip%' OR lower(x) LIKE '%logitech%' OR lower(x) LIKE '%cubot%' OR lower(x) LIKE '%blackshark%' OR lower(x) LIKE '%fairphone%' OR lower(x) LIKE '%wingtech%' OR lower(x) LIKE '%oukitel%' OR lower(x) LIKE '%vestelvenus%' OR lower(x) LIKE '%leiminmate%' OR lower(x) LIKE 'sharp%' OR lower(x) LIKE '%sharp%' OR lower(x) LIKE 'lenovolenovo%' OR lower(x) LIKE '%lenovolenovo%' OR lower(x) LIKE 'nothinga%' OR lower(x) LIKE '%nothinga%' OR lower(x) LIKE 'asus%' OR lower(x) LIKE '%asus%' OR lower(x) LIKE 'ipad%' OR lower(x) LIKE 'lge%' OR lower(x) LIKE '%lge%' OR lower(x) LIKE 'tcl%' OR lower(x) LIKE '%tcl%' OR lower(x) LIKE 'zte%' OR lower(x) LIKE '%zte%' OR lower(x) LIKE 'htc%' OR lower(x) LIKE '%htc%' OR lower(x) LIKE 'hxy%' OR lower(x) LIKE '%hxy%' OR lower(x) LIKE 'wiko%' OR lower(x) LIKE '%wiko%' OR lower(x) LIKE 'jio%' OR lower(x) LIKE '%jio%' OR lower(x) LIKE 'itel%' OR lower(x) LIKE '%itel%' OR lower(x) LIKE '%results%' OR lower(x) RLIKE '^(smtp|api|mdm|vpn|dns|rda|uag|dc|cpms|console|wsus)\\\\\\\\d*$' OR lower(x) RLIKE '^(' || 'static(-\\\\\\\\d+(-\\\\\\\\d+)?)?' || '|host-\\\\\\\\d{2,3}' || '|h-\\\\\\\\d{2,3}' || '|\\\\\\\\d{2,3}' || '|v\\\\\\\\d{4}' || '|(mx|ns)\\\\\\\\d+' || '|tlscmx\\\\\\\\d+' || '|pw-ether\\\\\\\\d+' || '|ftp|vpn|api|dev|mail|sso|host|survey|teleperformance|pacificinterpreters|unknown|ns03|webmail|survey|languageline|static|tlscontact|travelisa|mi-bospo|autodiscover|extranet|nameless|www|deffmtpc01|teleperformance' || ')$' OR lower(x) IN ( 'portal', 'tp', 'bog', 'lap-l', '[no results]', 'host', 'console', 'mail', 'www', '192', 'static', '.', 'iphone de lenovo', 'user deleted for this device', 'apple', 'fs', 'mohamed', '(2)', '-pc', 'admin', 'desktop', 'imac', 'dell', 'localhost', 'dell-pc', 'mac', 'med', 'med-' ) ) THEN 1 WHEN EXISTS( fqdn, x -> SPLIT(x, '\\\\\\\\.') [SIZE( SPLIT(x, '\\\\\\\\.') ) - 1] RLIKE '\\\\\\\\s' OR SPLIT(x, '\\\\\\\\.') [SIZE( SPLIT(x, '\\\\\\\\.') ) - 1] RLIKE '\\\\'' OR SPLIT(x, ' \\\\\\\\.')[SIZE(SPLIT(x, ' \\\\\\\\.')) - 1] RLIKE ' ^ \\\\\\\\d + $ ' OR LENGTH(SPLIT(x, ' \\\\\\\\.')[0]) <= 2 OR LENGTH(SPLIT(x, ' \\\\\\\\.')[SIZE(SPLIT(x, ' \\\\\\\\.')) - 1]) <= 1 OR lower(SPLIT(x, ' \\\\\\\\.')[SIZE(SPLIT(x, ' \\\\\\\\.')) - 1]) IN (' lan ') ) THEN 1 WHEN EXISTS(cloud_provider_unique_id, x -> x IS NOT NULL) THEN 1 WHEN EXISTS(cloud_resource_id, x -> x IS NOT NULL) THEN 1 WHEN lower(domain) RLIKE ' ^( work | workgroup | unknown | no domain | none ) $ ' THEN 1 WHEN lower(domain) LIKE ' % error % ' OR lower(domain) LIKE ' % result % ' THEN 1 WHEN lower(os_family) IN (' ios ', ' android ') THEN 1 WHEN lower(type) = ' container ' THEN 1 WHEN MAX(last_active_date) OVER (PARTITION BY host_name, fqdn) IS NULL THEN 1 WHEN last_active_date = MAX(last_active_date) OVER (PARTITION BY host_name, fqdn) THEN 1 ELSE 0 END\"", "}"], "removed_lines": ["\"colExpr\": \"CASE WHEN EXISTS(host_name, x -> lower(x) = '*' OR lower(x) LIKE '%iphone%' OR lower(x) LIKE '%androidenterprise%' OR lower(x) LIKE '%androidforwork%' OR lower(x) LIKE '%android%' OR lower(x) LIKE '%ipad%' OR lower(x) LIKE '% ipad %' OR lower(x) LIKE '%acer%' OR lower(x) RLIKE 'macbook' OR lower(x) LIKE '%samsungsm%' OR lower(x) LIKE '%samsungsc%' OR lower(x) LIKE '%samsungsamsung%' OR lower(x) LIKE '%xiaomi%' OR lower(x) LIKE '%huawei%' OR lower(x) LIKE '%motorola%' OR lower(x) LIKE '%oppo%' OR lower(x) LIKE '%googlepixel%' OR lower(x) LIKE '%vodafone%' OR lower(x) LIKE '%oneplus%' OR lower(x) LIKE '%realme%' OR lower(x) LIKE '%honor%' OR lower(x) LIKE '%vivo%' OR lower(x) LIKE '%infinix%' OR lower(x) LIKE '%freescale%' OR lower(x) LIKE '%sony%' OR lower(x) LIKE '%tecno mobile%' OR lower(x) LIKE '%tecno%' OR lower(x) LIKE '%ipod%' OR lower(x) LIKE '%blackberry%' OR lower(x) LIKE '%tecnotecno%' OR lower(x) LIKE '%nokia%' OR lower(x) LIKE '%blackview%' OR lower(x) LIKE '%kornsifero%' OR lower(x) LIKE '%hmd global%' OR lower(x) LIKE '%hmd%' OR lower(x) LIKE '%nubia%' OR lower(x) LIKE '%general mobile%' OR lower(x) LIKE '%reeder%' OR lower(x) LIKE '%microsoft%' OR lower(x) LIKE '%polystudio%' OR lower(x) LIKE '%rockchip%' OR lower(x) LIKE '%logitech%' OR lower(x) LIKE '%cubot%' OR lower(x) LIKE '%blackshark%' OR lower(x) LIKE '%fairphone%' OR lower(x) LIKE '%wingtech%' OR lower(x) LIKE '%oukitel%' OR lower(x) LIKE '%vestelvenus%' OR lower(x) LIKE '%leiminmate%' OR lower(x) LIKE 'sharp%' OR lower(x) LIKE '%sharp%' OR lower(x) LIKE 'lenovolenovo%' OR lower(x) LIKE '%lenovolenovo%' OR lower(x) LIKE 'nothinga%' OR lower(x) LIKE '%nothinga%' OR lower(x) LIKE 'asus%' OR lower(x) LIKE '%asus%' OR lower(x) LIKE 'ipad%' OR lower(x) LIKE 'lge%' OR lower(x) LIKE '%lge%' OR lower(x) LIKE 'tcl%' OR lower(x) LIKE '%tcl%' OR lower(x) LIKE 'zte%' OR lower(x) LIKE '%zte%' OR lower(x) LIKE 'htc%' OR lower(x) LIKE '%htc%' OR lower(x) LIKE 'hxy%' OR lower(x) LIKE '%hxy%' OR lower(x) LIKE 'wiko%' OR lower(x) LIKE '%wiko%' OR lower(x) LIKE 'jio%' OR lower(x) LIKE '%jio%' OR lower(x) LIKE 'itel%' OR lower(x) LIKE '%itel%' OR lower(x) LIKE '%results%' OR lower(x) RLIKE '^(smtp|api|mdm|vpn|dns|rda|uag|dc|cpms|console|wsus)\\\\\\\\d*$' OR lower(x) RLIKE '^(' || 'static(-\\\\\\\\d+(-\\\\\\\\d+)?)?' || '|host-\\\\\\\\d{2,3}' || '|h-\\\\\\\\d{2,3}' || '|\\\\\\\\d{2,3}' || '|v\\\\\\\\d{4}' || '|(mx|ns)\\\\\\\\d+' || '|tlscmx\\\\\\\\d+' || '|pw-ether\\\\\\\\d+' || '|ftp|vpn|api|dev|mail|sso|host|survey|teleperformance|pacificinterpreters|unknown|ns03|webmail|survey|languageline|static|tlscontact|travelisa|mi-bospo|autodiscover|extranet|nameless|www|deffmtpc01|teleperformance' || ')$' OR lower(x) IN ( 'portal','tp','bog','lap-l','[no results]','host','console','mail','www', '192','static','.','iphone de lenovo','user deleted for this device','apple', 'fs','mohamed','(2)','-pc','admin','desktop','imac','dell','localhost', 'dell-pc','mac','med','med-' ) ) THEN 1 WHEN EXISTS(fqdn, x -> SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1] RLIKE '\\\\\\\\s' OR SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1] RLIKE '\\\\'' OR SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1] RLIKE '^\\\\\\\\d+$' OR LENGTH(SPLIT(x, '\\\\\\\\.')[0]) <= 2 OR LENGTH(SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1]) <= 1 OR lower(SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1]) IN ('lan') ) THEN 1 WHEN EXISTS(cloud_provider_unique_id, x -> x IS NOT NULL) THEN 1 WHEN EXISTS(cloud_resource_id, x -> x IS NOT NULL) THEN 1 WHEN lower(domain) RLIKE '^(work|workgroup|unknown|no domain|none)$' THEN 1 WHEN lower(domain) LIKE '%error%' OR lower(domain) LIKE '%result%' THEN 1 WHEN lower(os_family) IN ('ios', 'android') THEN 1 WHEN lower(type) = 'container' THEN 1 WHEN MAX(last_active_date) OVER (PARTITION BY host_name, fqdn) IS NULL THEN 1 WHEN last_active_date = MAX(last_active_date) OVER (PARTITION BY host_name, fqdn) THEN 1 ELSE 0 END AS latest_flag\"", "}"]}]}, {"summary": "This pull request modifies the `sds_ei__host__ms_azure_ad__job_config.json` file to improve null handling in the Azure AD data processing logic. Specifically, it adds a check for empty `host_name` and `fqdn` arrays before applying the existing logic, and removes the alias `AS latest_flag` from the end of the `colExpr` definition.", "files_changed": [{"file_path": "configs/sds_ei_configs/spark_job_configs/source_models/intrasource_disambiguated_models/sds_ei__host__ms_azure_ad__job_config.json", "change_type": "modified", "added_lines": ["\"colExpr\": \"CASE WHEN SIZE(host_name) < 1 AND SIZE(fqdn) < 1 THEN 1 WHEN EXISTS( host_name, x -> lower(x) = '*' OR lower(x) LIKE '%iphone%' OR lower(x) LIKE '%androidenterprise%' OR lower(x) LIKE '%androidforwork%' OR lower(x) LIKE '%android%' OR lower(x) LIKE '%ipad%' OR lower(x) LIKE '% ipad %' OR lower(x) LIKE '%acer%' OR lower(x) RLIKE 'macbook' OR lower(x) LIKE '%samsungsm%' OR lower(x) LIKE '%samsungsc%' OR lower(x) LIKE '%samsungsamsung%' OR lower(x) LIKE '%xiaomi%' OR lower(x) LIKE '%huawei%' OR lower(x) LIKE '%motorola%' OR lower(x) LIKE '%oppo%' OR lower(x) LIKE '%googlepixel%' OR lower(x) LIKE '%vodafone%' OR lower(x) LIKE '%oneplus%' OR lower(x) LIKE '%realme%' OR lower(x) LIKE '%honor%' OR lower(x) LIKE '%vivo%' OR lower(x) LIKE '%infinix%' OR lower(x) LIKE '%freescale%' OR lower(x) LIKE '%sony%' OR lower(x) LIKE '%tecno mobile%' OR lower(x) LIKE '%tecno%' OR lower(x) LIKE '%ipod%' OR lower(x) LIKE '%blackberry%' OR lower(x) LIKE '%tecnotecno%' OR lower(x) LIKE '%nokia%' OR lower(x) LIKE '%blackview%' OR lower(x) LIKE '%kornsifero%' OR lower(x) LIKE '%hmd global%' OR lower(x) LIKE '%hmd%' OR lower(x) LIKE '%nubia%' OR lower(x) LIKE '%general mobile%' OR lower(x) LIKE '%reeder%' OR lower(x) LIKE '%microsoft%' OR lower(x) LIKE '%polystudio%' OR lower(x) LIKE '%rockchip%' OR lower(x) LIKE '%logitech%' OR lower(x) LIKE '%cubot%' OR lower(x) LIKE '%blackshark%' OR lower(x) LIKE '%fairphone%' OR lower(x) LIKE '%wingtech%' OR lower(x) LIKE '%oukitel%' OR lower(x) LIKE '%vestelvenus%' OR lower(x) LIKE '%leiminmate%' OR lower(x) LIKE 'sharp%' OR lower(x) LIKE '%sharp%' OR lower(x) LIKE 'lenovolenovo%' OR lower(x) LIKE '%lenovolenovo%' OR lower(x) LIKE 'nothinga%' OR lower(x) LIKE '%nothinga%' OR lower(x) LIKE 'asus%' OR lower(x) LIKE '%asus%' OR lower(x) LIKE 'ipad%' OR lower(x) LIKE 'lge%' OR lower(x) LIKE '%lge%' OR lower(x) LIKE 'tcl%' OR lower(x) LIKE '%tcl%' OR lower(x) LIKE 'zte%' OR lower(x) LIKE '%zte%' OR lower(x) LIKE 'htc%' OR lower(x) LIKE '%htc%' OR lower(x) LIKE 'hxy%' OR lower(x) LIKE '%hxy%' OR lower(x) LIKE 'wiko%' OR lower(x) LIKE '%wiko%' OR lower(x) LIKE 'jio%' OR lower(x) LIKE '%jio%' OR lower(x) LIKE 'itel%' OR lower(x) LIKE '%itel%' OR lower(x) LIKE '%results%' OR lower(x) RLIKE '^(smtp|api|mdm|vpn|dns|rda|uag|dc|cpms|console|wsus)\\\\\\\\d*$' OR lower(x) RLIKE '^(' || 'static(-\\\\\\\\d+(-\\\\\\\\d+)?)?' || '|host-\\\\\\\\d{2,3}' || '|h-\\\\\\\\d{2,3}' || '|\\\\\\\\d{2,3}' || '|v\\\\\\\\d{4}' || '|(mx|ns)\\\\\\\\d+' || '|tlscmx\\\\\\\\d+' || '|pw-ether\\\\\\\\d+' || '|ftp|vpn|api|dev|mail|sso|host|survey|teleperformance|pacificinterpreters|unknown|ns03|webmail|survey|languageline|static|tlscontact|travelisa|mi-bospo|autodiscover|extranet|nameless|www|deffmtpc01|teleperformance' || ')$' OR lower(x) IN ( 'portal', 'tp', 'bog', 'lap-l', '[no results]', 'host', 'console', 'mail', 'www', '192', 'static', '.', 'iphone de lenovo', 'user deleted for this device', 'apple', 'fs', 'mohamed', '(2)', '-pc', 'admin', 'desktop', 'imac', 'dell', 'localhost', 'dell-pc', 'mac', 'med', 'med-' ) ) THEN 1 WHEN EXISTS( fqdn, x -> SPLIT(x, '\\\\\\\\.') [SIZE( SPLIT(x, '\\\\\\\\.') ) - 1] RLIKE '\\\\\\\\s' OR SPLIT(x, '\\\\\\\\.') [SIZE( SPLIT(x, '\\\\\\\\.') ) - 1] RLIKE '\\\\'' OR SPLIT(x, ' \\\\\\\\.')[SIZE(SPLIT(x, ' \\\\\\\\.')) - 1] RLIKE ' ^ \\\\\\\\d + $ ' OR LENGTH(SPLIT(x, ' \\\\\\\\.')[0]) <= 2 OR LENGTH(SPLIT(x, ' \\\\\\\\.')[SIZE(SPLIT(x, ' \\\\\\\\.')) - 1]) <= 1 OR lower(SPLIT(x, ' \\\\\\\\.')[SIZE(SPLIT(x, ' \\\\\\\\.')) - 1]) IN (' lan ') ) THEN 1 WHEN EXISTS(cloud_provider_unique_id, x -> x IS NOT NULL) THEN 1 WHEN EXISTS(cloud_resource_id, x -> x IS NOT NULL) THEN 1 WHEN lower(domain) RLIKE ' ^( work | workgroup | unknown | no domain | none ) $ ' THEN 1 WHEN lower(domain) LIKE ' % error % ' OR lower(domain) LIKE ' % result % ' THEN 1 WHEN lower(os_family) IN (' ios ', ' android ') THEN 1 WHEN lower(type) = ' container ' THEN 1 WHEN MAX(last_active_date) OVER (PARTITION BY host_name, fqdn) IS NULL THEN 1 WHEN last_active_date = MAX(last_active_date) OVER (PARTITION BY host_name, fqdn) THEN 1 ELSE 0 END\"", "}"], "removed_lines": ["\"colExpr\": \"CASE WHEN EXISTS(host_name, x -> lower(x) = '*' OR lower(x) LIKE '%iphone%' OR lower(x) LIKE '%androidenterprise%' OR lower(x) LIKE '%androidforwork%' OR lower(x) LIKE '%android%' OR lower(x) LIKE '%ipad%' OR lower(x) LIKE '% ipad %' OR lower(x) LIKE '%acer%' OR lower(x) RLIKE 'macbook' OR lower(x) LIKE '%samsungsm%' OR lower(x) LIKE '%samsungsc%' OR lower(x) LIKE '%samsungsamsung%' OR lower(x) LIKE '%xiaomi%' OR lower(x) LIKE '%huawei%' OR lower(x) LIKE '%motorola%' OR lower(x) LIKE '%oppo%' OR lower(x) LIKE '%googlepixel%' OR lower(x) LIKE '%vodafone%' OR lower(x) LIKE '%oneplus%' OR lower(x) LIKE '%realme%' OR lower(x) LIKE '%honor%' OR lower(x) LIKE '%vivo%' OR lower(x) LIKE '%infinix%' OR lower(x) LIKE '%freescale%' OR lower(x) LIKE '%sony%' OR lower(x) LIKE '%tecno mobile%' OR lower(x) LIKE '%tecno%' OR lower(x) LIKE '%ipod%' OR lower(x) LIKE '%blackberry%' OR lower(x) LIKE '%tecnotecno%' OR lower(x) LIKE '%nokia%' OR lower(x) LIKE '%blackview%' OR lower(x) LIKE '%kornsifero%' OR lower(x) LIKE '%hmd global%' OR lower(x) LIKE '%hmd%' OR lower(x) LIKE '%nubia%' OR lower(x) LIKE '%general mobile%' OR lower(x) LIKE '%reeder%' OR lower(x) LIKE '%microsoft%' OR lower(x) LIKE '%polystudio%' OR lower(x) LIKE '%rockchip%' OR lower(x) LIKE '%logitech%' OR lower(x) LIKE '%cubot%' OR lower(x) LIKE '%blackshark%' OR lower(x) LIKE '%fairphone%' OR lower(x) LIKE '%wingtech%' OR lower(x) LIKE '%oukitel%' OR lower(x) LIKE '%vestelvenus%' OR lower(x) LIKE '%leiminmate%' OR lower(x) LIKE 'sharp%' OR lower(x) LIKE '%sharp%' OR lower(x) LIKE 'lenovolenovo%' OR lower(x) LIKE '%lenovolenovo%' OR lower(x) LIKE 'nothinga%' OR lower(x) LIKE '%nothinga%' OR lower(x) LIKE 'asus%' OR lower(x) LIKE '%asus%' OR lower(x) LIKE 'ipad%' OR lower(x) LIKE 'lge%' OR lower(x) LIKE '%lge%' OR lower(x) LIKE 'tcl%' OR lower(x) LIKE '%tcl%' OR lower(x) LIKE 'zte%' OR lower(x) LIKE '%zte%' OR lower(x) LIKE 'htc%' OR lower(x) LIKE '%htc%' OR lower(x) LIKE 'hxy%' OR lower(x) LIKE '%hxy%' OR lower(x) LIKE 'wiko%' OR lower(x) LIKE '%wiko%' OR lower(x) LIKE 'jio%' OR lower(x) LIKE '%jio%' OR lower(x) LIKE 'itel%' OR lower(x) LIKE '%itel%' OR lower(x) LIKE '%results%' OR lower(x) RLIKE '^(smtp|api|mdm|vpn|dns|rda|uag|dc|cpms|console|wsus)\\\\\\\\d*$' OR lower(x) RLIKE '^(' || 'static(-\\\\\\\\d+(-\\\\\\\\d+)?)?' || '|host-\\\\\\\\d{2,3}' || '|h-\\\\\\\\d{2,3}' || '|\\\\\\\\d{2,3}' || '|v\\\\\\\\d{4}' || '|(mx|ns)\\\\\\\\d+' || '|tlscmx\\\\\\\\d+' || '|pw-ether\\\\\\\\d+' || '|ftp|vpn|api|dev|mail|sso|host|survey|teleperformance|pacificinterpreters|unknown|ns03|webmail|survey|languageline|static|tlscontact|travelisa|mi-bospo|autodiscover|extranet|nameless|www|deffmtpc01|teleperformance' || ')$' OR lower(x) IN ( 'portal','tp','bog','lap-l','[no results]','host','console','mail','www', '192','static','.','iphone de lenovo','user deleted for this device','apple', 'fs','mohamed','(2)','-pc','admin','desktop','imac','dell','localhost', 'dell-pc','mac','med','med-' ) ) THEN 1 WHEN EXISTS(fqdn, x -> SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1] RLIKE '\\\\\\\\s' OR SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1] RLIKE '\\\\'' OR SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1] RLIKE '^\\\\\\\\d+$' OR LENGTH(SPLIT(x, '\\\\\\\\.')[0]) <= 2 OR LENGTH(SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1]) <= 1 OR lower(SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1]) IN ('lan') ) THEN 1 WHEN EXISTS(cloud_provider_unique_id, x -> x IS NOT NULL) THEN 1 WHEN EXISTS(cloud_resource_id, x -> x IS NOT NULL) THEN 1 WHEN lower(domain) RLIKE '^(work|workgroup|unknown|no domain|none)$' THEN 1 WHEN lower(domain) LIKE '%error%' OR lower(domain) LIKE '%result%' THEN 1 WHEN lower(os_family) IN ('ios', 'android') THEN 1 WHEN lower(type) = 'container' THEN 1 WHEN MAX(last_active_date) OVER (PARTITION BY host_name, fqdn) IS NULL THEN 1 WHEN last_active_date = MAX(last_active_date) OVER (PARTITION BY host_name, fqdn) THEN 1 ELSE 0 END AS latest_flag\"", "}"]}]}, {"summary": "The pull request modifies the `sds_ei__host__ms_intune__job_config.json` file to improve null handling in the Intune data source. Specifically, it adds a check for empty `host_name` and `fqdn` lists, and removes the `latest_flag` alias from the `colExpr` definition.", "files_changed": [{"file_path": "configs/sds_ei_configs/spark_job_configs/source_models/intrasource_disambiguated_models/sds_ei__host__ms_intune__job_config.json", "change_type": "modified", "added_lines": ["\"colExpr\": \"CASE WHEN SIZE(host_name) < 1 AND SIZE(fqdn) < 1 THEN 1 WHEN EXISTS( host_name, x -> lower(x) = '*' OR lower(x) LIKE '%iphone%' OR lower(x) LIKE '%androidenterprise%' OR lower(x) LIKE '%androidforwork%' OR lower(x) LIKE '%android%' OR lower(x) LIKE '%ipad%' OR lower(x) LIKE '% ipad %' OR lower(x) LIKE '%acer%' OR lower(x) RLIKE 'macbook' OR lower(x) LIKE '%samsungsm%' OR lower(x) LIKE '%samsungsc%' OR lower(x) LIKE '%samsungsamsung%' OR lower(x) LIKE '%xiaomi%' OR lower(x) LIKE '%huawei%' OR lower(x) LIKE '%motorola%' OR lower(x) LIKE '%oppo%' OR lower(x) LIKE '%googlepixel%' OR lower(x) LIKE '%vodafone%' OR lower(x) LIKE '%oneplus%' OR lower(x) LIKE '%realme%' OR lower(x) LIKE '%honor%' OR lower(x) LIKE '%vivo%' OR lower(x) LIKE '%infinix%' OR lower(x) LIKE '%freescale%' OR lower(x) LIKE '%sony%' OR lower(x) LIKE '%tecno mobile%' OR lower(x) LIKE '%tecno%' OR lower(x) LIKE '%ipod%' OR lower(x) LIKE '%blackberry%' OR lower(x) LIKE '%tecnotecno%' OR lower(x) LIKE '%nokia%' OR lower(x) LIKE '%blackview%' OR lower(x) LIKE '%kornsifero%' OR lower(x) LIKE '%hmd global%' OR lower(x) LIKE '%hmd%' OR lower(x) LIKE '%nubia%' OR lower(x) LIKE '%general mobile%' OR lower(x) LIKE '%reeder%' OR lower(x) LIKE '%microsoft%' OR lower(x) LIKE '%polystudio%' OR lower(x) LIKE '%rockchip%' OR lower(x) LIKE '%logitech%' OR lower(x) LIKE '%cubot%' OR lower(x) LIKE '%blackshark%' OR lower(x) LIKE '%fairphone%' OR lower(x) LIKE '%wingtech%' OR lower(x) LIKE '%oukitel%' OR lower(x) LIKE '%vestelvenus%' OR lower(x) LIKE '%leiminmate%' OR lower(x) LIKE 'sharp%' OR lower(x) LIKE '%sharp%' OR lower(x) LIKE 'lenovolenovo%' OR lower(x) LIKE '%lenovolenovo%' OR lower(x) LIKE 'nothinga%' OR lower(x) LIKE '%nothinga%' OR lower(x) LIKE 'asus%' OR lower(x) LIKE '%asus%' OR lower(x) LIKE 'ipad%' OR lower(x) LIKE 'lge%' OR lower(x) LIKE '%lge%' OR lower(x) LIKE 'tcl%' OR lower(x) LIKE '%tcl%' OR lower(x) LIKE 'zte%' OR lower(x) LIKE '%zte%' OR lower(x) LIKE 'htc%' OR lower(x) LIKE '%htc%' OR lower(x) LIKE 'hxy%' OR lower(x) LIKE '%hxy%' OR lower(x) LIKE 'wiko%' OR lower(x) LIKE '%wiko%' OR lower(x) LIKE 'jio%' OR lower(x) LIKE '%jio%' OR lower(x) LIKE 'itel%' OR lower(x) LIKE '%itel%' OR lower(x) LIKE '%results%' OR lower(x) RLIKE '^(smtp|api|mdm|vpn|dns|rda|uag|dc|cpms|console|wsus)\\\\\\\\d*$' OR lower(x) RLIKE '^(' || 'static(-\\\\\\\\d+(-\\\\\\\\d+)?)?' || '|host-\\\\\\\\d{2,3}' || '|h-\\\\\\\\d{2,3}' || '|\\\\\\\\d{2,3}' || '|v\\\\\\\\d{4}' || '|(mx|ns)\\\\\\\\d+' || '|tlscmx\\\\\\\\d+' || '|pw-ether\\\\\\\\d+' || '|ftp|vpn|api|dev|mail|sso|host|survey|teleperformance|pacificinterpreters|unknown|ns03|webmail|survey|languageline|static|tlscontact|travelisa|mi-bospo|autodiscover|extranet|nameless|www|deffmtpc01|teleperformance' || ')$' OR lower(x) IN ( 'portal', 'tp', 'bog', 'lap-l', '[no results]', 'host', 'console', 'mail', 'www', '192', 'static', '.', 'iphone de lenovo', 'user deleted for this device', 'apple', 'fs', 'mohamed', '(2)', '-pc', 'admin', 'desktop', 'imac', 'dell', 'localhost', 'dell-pc', 'mac', 'med', 'med-' ) ) THEN 1 WHEN EXISTS( fqdn, x -> SPLIT(x, '\\\\\\\\.') [SIZE( SPLIT(x, '\\\\\\\\.') ) - 1] RLIKE '\\\\\\\\s' OR SPLIT(x, '\\\\\\\\.') [SIZE( SPLIT(x, '\\\\\\\\.') ) - 1] RLIKE '\\\\'' OR SPLIT(x, ' \\\\\\\\.')[SIZE(SPLIT(x, ' \\\\\\\\.')) - 1] RLIKE ' ^ \\\\\\\\d + $ ' OR LENGTH(SPLIT(x, ' \\\\\\\\.')[0]) <= 2 OR LENGTH(SPLIT(x, ' \\\\\\\\.')[SIZE(SPLIT(x, ' \\\\\\\\.')) - 1]) <= 1 OR lower(SPLIT(x, ' \\\\\\\\.')[SIZE(SPLIT(x, ' \\\\\\\\.')) - 1]) IN (' lan ') ) THEN 1 WHEN EXISTS(cloud_provider_unique_id, x -> x IS NOT NULL) THEN 1 WHEN EXISTS(cloud_resource_id, x -> x IS NOT NULL) THEN 1 WHEN lower(domain) RLIKE ' ^( work | workgroup | unknown | no domain | none ) $ ' THEN 1 WHEN lower(domain) LIKE ' % error % ' OR lower(domain) LIKE ' % result % ' THEN 1 WHEN lower(os_family) IN (' ios ', ' android ') THEN 1 WHEN lower(type) = ' container ' THEN 1 WHEN MAX(last_active_date) OVER (PARTITION BY host_name, fqdn) IS NULL THEN 1 WHEN last_active_date = MAX(last_active_date) OVER (PARTITION BY host_name, fqdn) THEN 1 ELSE 0 END\"", "}"], "removed_lines": ["\"colExpr\": \"CASE WHEN EXISTS(host_name, x -> lower(x) = '*' OR lower(x) LIKE '%iphone%' OR lower(x) LIKE '%androidenterprise%' OR lower(x) LIKE '%androidforwork%' OR lower(x) LIKE '%android%' OR lower(x) LIKE '%ipad%' OR lower(x) LIKE '% ipad %' OR lower(x) LIKE '%acer%' OR lower(x) RLIKE 'macbook' OR lower(x) LIKE '%samsungsm%' OR lower(x) LIKE '%samsungsc%' OR lower(x) LIKE '%samsungsamsung%' OR lower(x) LIKE '%xiaomi%' OR lower(x) LIKE '%huawei%' OR lower(x) LIKE '%motorola%' OR lower(x) LIKE '%oppo%' OR lower(x) LIKE '%googlepixel%' OR lower(x) LIKE '%vodafone%' OR lower(x) LIKE '%oneplus%' OR lower(x) LIKE '%realme%' OR lower(x) LIKE '%honor%' OR lower(x) LIKE '%vivo%' OR lower(x) LIKE '%infinix%' OR lower(x) LIKE '%freescale%' OR lower(x) LIKE '%sony%' OR lower(x) LIKE '%tecno mobile%' OR lower(x) LIKE '%tecno%' OR lower(x) LIKE '%ipod%' OR lower(x) LIKE '%blackberry%' OR lower(x) LIKE '%tecnotecno%' OR lower(x) LIKE '%nokia%' OR lower(x) LIKE '%blackview%' OR lower(x) LIKE '%kornsifero%' OR lower(x) LIKE '%hmd global%' OR lower(x) LIKE '%hmd%' OR lower(x) LIKE '%nubia%' OR lower(x) LIKE '%general mobile%' OR lower(x) LIKE '%reeder%' OR lower(x) LIKE '%microsoft%' OR lower(x) LIKE '%polystudio%' OR lower(x) LIKE '%rockchip%' OR lower(x) LIKE '%logitech%' OR lower(x) LIKE '%cubot%' OR lower(x) LIKE '%blackshark%' OR lower(x) LIKE '%fairphone%' OR lower(x) LIKE '%wingtech%' OR lower(x) LIKE '%oukitel%' OR lower(x) LIKE '%vestelvenus%' OR lower(x) LIKE '%leiminmate%' OR lower(x) LIKE 'sharp%' OR lower(x) LIKE '%sharp%' OR lower(x) LIKE 'lenovolenovo%' OR lower(x) LIKE '%lenovolenovo%' OR lower(x) LIKE 'nothinga%' OR lower(x) LIKE '%nothinga%' OR lower(x) LIKE 'asus%' OR lower(x) LIKE '%asus%' OR lower(x) LIKE 'ipad%' OR lower(x) LIKE 'lge%' OR lower(x) LIKE '%lge%' OR lower(x) LIKE 'tcl%' OR lower(x) LIKE '%tcl%' OR lower(x) LIKE 'zte%' OR lower(x) LIKE '%zte%' OR lower(x) LIKE 'htc%' OR lower(x) LIKE '%htc%' OR lower(x) LIKE 'hxy%' OR lower(x) LIKE '%hxy%' OR lower(x) LIKE 'wiko%' OR lower(x) LIKE '%wiko%' OR lower(x) LIKE 'jio%' OR lower(x) LIKE '%jio%' OR lower(x) LIKE 'itel%' OR lower(x) LIKE '%itel%' OR lower(x) LIKE '%results%' OR lower(x) RLIKE '^(smtp|api|mdm|vpn|dns|rda|uag|dc|cpms|console|wsus)\\\\\\\\d*$' OR lower(x) RLIKE '^(' || 'static(-\\\\\\\\d+(-\\\\\\\\d+)?)?' || '|host-\\\\\\\\d{2,3}' || '|h-\\\\\\\\d{2,3}' || '|\\\\\\\\d{2,3}' || '|v\\\\\\\\d{4}' || '|(mx|ns)\\\\\\\\d+' || '|tlscmx\\\\\\\\d+' || '|pw-ether\\\\\\\\d+' || '|ftp|vpn|api|dev|mail|sso|host|survey|teleperformance|pacificinterpreters|unknown|ns03|webmail|survey|languageline|static|tlscontact|travelisa|mi-bospo|autodiscover|extranet|nameless|www|deffmtpc01|teleperformance' || ')$' OR lower(x) IN ( 'portal','tp','bog','lap-l','[no results]','host','console','mail','www', '192','static','.','iphone de lenovo','user deleted for this device','apple', 'fs','mohamed','(2)','-pc','admin','desktop','imac','dell','localhost', 'dell-pc','mac','med','med-' ) ) THEN 1 WHEN EXISTS(fqdn, x -> SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1] RLIKE '\\\\\\\\s' OR SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1] RLIKE '\\\\'' OR SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1] RLIKE '^\\\\\\\\d+$' OR LENGTH(SPLIT(x, '\\\\\\\\.')[0]) <= 2 OR LENGTH(SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1]) <= 1 OR lower(SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1]) IN ('lan') ) THEN 1 WHEN EXISTS(cloud_provider_unique_id, x -> x IS NOT NULL) THEN 1 WHEN EXISTS(cloud_resource_id, x -> x IS NOT NULL) THEN 1 WHEN lower(domain) RLIKE '^(work|workgroup|unknown|no domain|none)$' THEN 1 WHEN lower(domain) LIKE '%error%' OR lower(domain) LIKE '%result%' THEN 1 WHEN lower(os_family) IN ('ios', 'android') THEN 1 WHEN lower(type) = 'container' THEN 1 WHEN MAX(last_active_date) OVER (PARTITION BY host_name, fqdn) IS NULL THEN 1 WHEN last_active_date = MAX(last_active_date) OVER (PARTITION BY host_name, fqdn) THEN 1 ELSE 0 END AS latest_flag\"", "}"]}]}, {"summary": "This pull request modifies the Qualys job configuration file to improve null handling and device identification logic. Specifically, it adds a check for empty host_name and fqdn lists, and refactors the final \"ELSE\" condition to remove the assignment of an alias `AS latest_flag` to the CASE statement.", "files_changed": [{"file_path": "configs/sds_ei_configs/spark_job_configs/source_models/intrasource_disambiguated_models/sds_ei__host__qualys__job_config.json", "change_type": "modified", "added_lines": ["\"colExpr\": \"CASE WHEN SIZE(host_name) < 1 AND SIZE(fqdn) < 1 THEN 1 WHEN EXISTS( host_name, x -> lower(x) = '*' OR lower(x) LIKE '%iphone%' OR lower(x) LIKE '%androidenterprise%' OR lower(x) LIKE '%androidforwork%' OR lower(x) LIKE '%android%' OR lower(x) LIKE '%ipad%' OR lower(x) LIKE '% ipad %' OR lower(x) LIKE '%acer%' OR lower(x) RLIKE 'macbook' OR lower(x) LIKE '%samsungsm%' OR lower(x) LIKE '%samsungsc%' OR lower(x) LIKE '%samsungsamsung%' OR lower(x) LIKE '%xiaomi%' OR lower(x) LIKE '%huawei%' OR lower(x) LIKE '%motorola%' OR lower(x) LIKE '%oppo%' OR lower(x) LIKE '%googlepixel%' OR lower(x) LIKE '%vodafone%' OR lower(x) LIKE '%oneplus%' OR lower(x) LIKE '%realme%' OR lower(x) LIKE '%honor%' OR lower(x) LIKE '%vivo%' OR lower(x) LIKE '%infinix%' OR lower(x) LIKE '%freescale%' OR lower(x) LIKE '%sony%' OR lower(x) LIKE '%tecno mobile%' OR lower(x) LIKE '%tecno%' OR lower(x) LIKE '%ipod%' OR lower(x) LIKE '%blackberry%' OR lower(x) LIKE '%tecnotecno%' OR lower(x) LIKE '%nokia%' OR lower(x) LIKE '%blackview%' OR lower(x) LIKE '%kornsifero%' OR lower(x) LIKE '%hmd global%' OR lower(x) LIKE '%hmd%' OR lower(x) LIKE '%nubia%' OR lower(x) LIKE '%general mobile%' OR lower(x) LIKE '%reeder%' OR lower(x) LIKE '%microsoft%' OR lower(x) LIKE '%polystudio%' OR lower(x) LIKE '%rockchip%' OR lower(x) LIKE '%logitech%' OR lower(x) LIKE '%cubot%' OR lower(x) LIKE '%blackshark%' OR lower(x) LIKE '%fairphone%' OR lower(x) LIKE '%wingtech%' OR lower(x) LIKE '%oukitel%' OR lower(x) LIKE '%vestelvenus%' OR lower(x) LIKE '%leiminmate%' OR lower(x) LIKE 'sharp%' OR lower(x) LIKE '%sharp%' OR lower(x) LIKE 'lenovolenovo%' OR lower(x) LIKE '%lenovolenovo%' OR lower(x) LIKE 'nothinga%' OR lower(x) LIKE '%nothinga%' OR lower(x) LIKE 'asus%' OR lower(x) LIKE '%asus%' OR lower(x) LIKE 'ipad%' OR lower(x) LIKE 'lge%' OR lower(x) LIKE '%lge%' OR lower(x) LIKE 'tcl%' OR lower(x) LIKE '%tcl%' OR lower(x) LIKE 'zte%' OR lower(x) LIKE '%zte%' OR lower(x) LIKE 'htc%' OR lower(x) LIKE '%htc%' OR lower(x) LIKE 'hxy%' OR lower(x) LIKE '%hxy%' OR lower(x) LIKE 'wiko%' OR lower(x) LIKE '%wiko%' OR lower(x) LIKE 'jio%' OR lower(x) LIKE '%jio%' OR lower(x) LIKE 'itel%' OR lower(x) LIKE '%itel%' OR lower(x) LIKE '%results%' OR lower(x) RLIKE '^(smtp|api|mdm|vpn|dns|rda|uag|dc|cpms|console|wsus)\\\\\\\\d*$' OR lower(x) RLIKE '^(' || 'static(-\\\\\\\\d+(-\\\\\\\\d+)?)?' || '|host-\\\\\\\\d{2,3}' || '|h-\\\\\\\\d{2,3}' || '|\\\\\\\\d{2,3}' || '|v\\\\\\\\d{4}' || '|(mx|ns)\\\\\\\\d+' || '|tlscmx\\\\\\\\d+' || '|pw-ether\\\\\\\\d+' || '|ftp|vpn|api|dev|mail|sso|host|survey|teleperformance|pacificinterpreters|unknown|ns03|webmail|survey|languageline|static|tlscontact|travelisa|mi-bospo|autodiscover|extranet|nameless|www|deffmtpc01|teleperformance' || ')$' OR lower(x) IN ( 'portal', 'tp', 'bog', 'lap-l', '[no results]', 'host', 'console', 'mail', 'www', '192', 'static', '.', 'iphone de lenovo', 'user deleted for this device', 'apple', 'fs', 'mohamed', '(2)', '-pc', 'admin', 'desktop', 'imac', 'dell', 'localhost', 'dell-pc', 'mac', 'med', 'med-' ) ) THEN 1 WHEN EXISTS( fqdn, x -> SPLIT(x, '\\\\\\\\.') [SIZE( SPLIT(x, '\\\\\\\\.') ) - 1] RLIKE '\\\\\\\\s' OR SPLIT(x, '\\\\\\\\.') [SIZE( SPLIT(x, '\\\\\\\\.') ) - 1] RLIKE '\\\\'' OR SPLIT(x, ' \\\\\\\\.')[SIZE(SPLIT(x, ' \\\\\\\\.')) - 1] RLIKE ' ^ \\\\\\\\d + $ ' OR LENGTH(SPLIT(x, ' \\\\\\\\.')[0]) <= 2 OR LENGTH(SPLIT(x, ' \\\\\\\\.')[SIZE(SPLIT(x, ' \\\\\\\\.')) - 1]) <= 1 OR lower(SPLIT(x, ' \\\\\\\\.')[SIZE(SPLIT(x, ' \\\\\\\\.')) - 1]) IN (' lan ') ) THEN 1 WHEN EXISTS(cloud_provider_unique_id, x -> x IS NOT NULL) THEN 1 WHEN EXISTS(cloud_resource_id, x -> x IS NOT NULL) THEN 1 WHEN lower(domain) RLIKE ' ^( work | workgroup | unknown | no domain | none ) $ ' THEN 1 WHEN lower(domain) LIKE ' % error % ' OR lower(domain) LIKE ' % result % ' THEN 1 WHEN lower(os_family) IN (' ios ', ' android ') THEN 1 WHEN lower(type) = ' container ' THEN 1 WHEN MAX(last_active_date) OVER (PARTITION BY host_name, fqdn) IS NULL THEN 1 WHEN last_active_date = MAX(last_active_date) OVER (PARTITION BY host_name, fqdn) THEN 1 ELSE 0 END\"", "}"], "removed_lines": ["\"colExpr\": \"CASE WHEN EXISTS(host_name, x -> lower(x) = '*' OR lower(x) LIKE '%iphone%' OR lower(x) LIKE '%androidenterprise%' OR lower(x) LIKE '%androidforwork%' OR lower(x) LIKE '%android%' OR lower(x) LIKE '%ipad%' OR lower(x) LIKE '% ipad %' OR lower(x) LIKE '%acer%' OR lower(x) RLIKE 'macbook' OR lower(x) LIKE '%samsungsm%' OR lower(x) LIKE '%samsungsc%' OR lower(x) LIKE '%samsungsamsung%' OR lower(x) LIKE '%xiaomi%' OR lower(x) LIKE '%huawei%' OR lower(x) LIKE '%motorola%' OR lower(x) LIKE '%oppo%' OR lower(x) LIKE '%googlepixel%' OR lower(x) LIKE '%vodafone%' OR lower(x) LIKE '%oneplus%' OR lower(x) LIKE '%realme%' OR lower(x) LIKE '%honor%' OR lower(x) LIKE '%vivo%' OR lower(x) LIKE '%infinix%' OR lower(x) LIKE '%freescale%' OR lower(x) LIKE '%sony%' OR lower(x) LIKE '%tecno mobile%' OR lower(x) LIKE '%tecno%' OR lower(x) LIKE '%ipod%' OR lower(x) LIKE '%blackberry%' OR lower(x) LIKE '%tecnotecno%' OR lower(x) LIKE '%nokia%' OR lower(x) LIKE '%blackview%' OR lower(x) LIKE '%kornsifero%' OR lower(x) LIKE '%hmd global%' OR lower(x) LIKE '%hmd%' OR lower(x) LIKE '%nubia%' OR lower(x) LIKE '%general mobile%' OR lower(x) LIKE '%reeder%' OR lower(x) LIKE '%microsoft%' OR lower(x) LIKE '%polystudio%' OR lower(x) LIKE '%rockchip%' OR lower(x) LIKE '%logitech%' OR lower(x) LIKE '%cubot%' OR lower(x) LIKE '%blackshark%' OR lower(x) LIKE '%fairphone%' OR lower(x) LIKE '%wingtech%' OR lower(x) LIKE '%oukitel%' OR lower(x) LIKE '%vestelvenus%' OR lower(x) LIKE '%leiminmate%' OR lower(x) LIKE 'sharp%' OR lower(x) LIKE '%sharp%' OR lower(x) LIKE 'lenovolenovo%' OR lower(x) LIKE '%lenovolenovo%' OR lower(x) LIKE 'nothinga%' OR lower(x) LIKE '%nothinga%' OR lower(x) LIKE 'asus%' OR lower(x) LIKE '%asus%' OR lower(x) LIKE 'ipad%' OR lower(x) LIKE 'lge%' OR lower(x) LIKE '%lge%' OR lower(x) LIKE 'tcl%' OR lower(x) LIKE '%tcl%' OR lower(x) LIKE 'zte%' OR lower(x) LIKE '%zte%' OR lower(x) LIKE 'htc%' OR lower(x) LIKE '%htc%' OR lower(x) LIKE 'hxy%' OR lower(x) LIKE '%hxy%' OR lower(x) LIKE 'wiko%' OR lower(x) LIKE '%wiko%' OR lower(x) LIKE 'jio%' OR lower(x) LIKE '%jio%' OR lower(x) LIKE 'itel%' OR lower(x) LIKE '%itel%' OR lower(x) LIKE '%results%' OR lower(x) RLIKE '^(smtp|api|mdm|vpn|dns|rda|uag|dc|cpms|console|wsus)\\\\\\\\d*$' OR lower(x) RLIKE '^(' || 'static(-\\\\\\\\d+(-\\\\\\\\d+)?)?' || '|host-\\\\\\\\d{2,3}' || '|h-\\\\\\\\d{2,3}' || '|\\\\\\\\d{2,3}' || '|v\\\\\\\\d{4}' || '|(mx|ns)\\\\\\\\d+' || '|tlscmx\\\\\\\\d+' || '|pw-ether\\\\\\\\d+' || '|ftp|vpn|api|dev|mail|sso|host|survey|teleperformance|pacificinterpreters|unknown|ns03|webmail|survey|languageline|static|tlscontact|travelisa|mi-bospo|autodiscover|extranet|nameless|www|deffmtpc01|teleperformance' || ')$' OR lower(x) IN ( 'portal','tp','bog','lap-l','[no results]','host','console','mail','www', '192','static','.','iphone de lenovo','user deleted for this device','apple', 'fs','mohamed','(2)','-pc','admin','desktop','imac','dell','localhost', 'dell-pc','mac','med','med-' ) ) THEN 1 WHEN EXISTS(fqdn, x -> SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1] RLIKE '\\\\\\\\s' OR SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1] RLIKE '\\\\'' OR SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1] RLIKE '^\\\\\\\\d+$' OR LENGTH(SPLIT(x, '\\\\\\\\.')[0]) <= 2 OR LENGTH(SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1]) <= 1 OR lower(SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1]) IN ('lan') ) THEN 1 WHEN EXISTS(cloud_provider_unique_id, x -> x IS NOT NULL) THEN 1 WHEN EXISTS(cloud_resource_id, x -> x IS NOT NULL) THEN 1 WHEN lower(domain) RLIKE '^(work|workgroup|unknown|no domain|none)$' THEN 1 WHEN lower(domain) LIKE '%error%' OR lower(domain) LIKE '%result%' THEN 1 WHEN lower(os_family) IN ('ios', 'android') THEN 1 WHEN lower(type) = 'container' THEN 1 WHEN MAX(last_active_date) OVER (PARTITION BY host_name, fqdn) IS NULL THEN 1 WHEN last_active_date = MAX(last_active_date) OVER (PARTITION BY host_name, fqdn) THEN 1 ELSE 0 END AS latest_flag\"", "}"]}]}, {"summary": "The pull request modifies the `sds_ei__host__rapid7__job_config.json` file to improve null handling in the Rapid7 data source. Specifically, it updates the `colExpr` to include a check for empty `host_name` and `fqdn` lists, assigning a value of 1 if both are empty. It also adds spaces to the RLIKE expressions for the fqdn split to ensure correct parsing.", "files_changed": [{"file_path": "configs/sds_ei_configs/spark_job_configs/source_models/intrasource_disambiguated_models/sds_ei__host__rapid7__job_config.json", "change_type": "modified", "added_lines": ["\"colExpr\": \"CASE WHEN SIZE(host_name) < 1 AND SIZE(fqdn) < 1 THEN 1 WHEN EXISTS( host_name, x -> lower(x) = '*' OR lower(x) LIKE '%iphone%' OR lower(x) LIKE '%androidenterprise%' OR lower(x) LIKE '%androidforwork%' OR lower(x) LIKE '%android%' OR lower(x) LIKE '%ipad%' OR lower(x) LIKE '% ipad %' OR lower(x) LIKE '%acer%' OR lower(x) RLIKE 'macbook' OR lower(x) LIKE '%samsungsm%' OR lower(x) LIKE '%samsungsc%' OR lower(x) LIKE '%samsungsamsung%' OR lower(x) LIKE '%xiaomi%' OR lower(x) LIKE '%huawei%' OR lower(x) LIKE '%motorola%' OR lower(x) LIKE '%oppo%' OR lower(x) LIKE '%googlepixel%' OR lower(x) LIKE '%vodafone%' OR lower(x) LIKE '%oneplus%' OR lower(x) LIKE '%realme%' OR lower(x) LIKE '%honor%' OR lower(x) LIKE '%vivo%' OR lower(x) LIKE '%infinix%' OR lower(x) LIKE '%freescale%' OR lower(x) LIKE '%sony%' OR lower(x) LIKE '%tecno mobile%' OR lower(x) LIKE '%tecno%' OR lower(x) LIKE '%ipod%' OR lower(x) LIKE '%blackberry%' OR lower(x) LIKE '%tecnotecno%' OR lower(x) LIKE '%nokia%' OR lower(x) LIKE '%blackview%' OR lower(x) LIKE '%kornsifero%' OR lower(x) LIKE '%hmd global%' OR lower(x) LIKE '%hmd%' OR lower(x) LIKE '%nubia%' OR lower(x) LIKE '%general mobile%' OR lower(x) LIKE '%reeder%' OR lower(x) LIKE '%microsoft%' OR lower(x) LIKE '%polystudio%' OR lower(x) LIKE '%rockchip%' OR lower(x) LIKE '%logitech%' OR lower(x) LIKE '%cubot%' OR lower(x) LIKE '%blackshark%' OR lower(x) LIKE '%fairphone%' OR lower(x) LIKE '%wingtech%' OR lower(x) LIKE '%oukitel%' OR lower(x) LIKE '%vestelvenus%' OR lower(x) LIKE '%leiminmate%' OR lower(x) LIKE 'sharp%' OR lower(x) LIKE '%sharp%' OR lower(x) LIKE 'lenovolenovo%' OR lower(x) LIKE '%lenovolenovo%' OR lower(x) LIKE 'nothinga%' OR lower(x) LIKE '%nothinga%' OR lower(x) LIKE 'asus%' OR lower(x) LIKE '%asus%' OR lower(x) LIKE 'ipad%' OR lower(x) LIKE 'lge%' OR lower(x) LIKE '%lge%' OR lower(x) LIKE 'tcl%' OR lower(x) LIKE '%tcl%' OR lower(x) LIKE 'zte%' OR lower(x) LIKE '%zte%' OR lower(x) LIKE 'htc%' OR lower(x) LIKE '%htc%' OR lower(x) LIKE 'hxy%' OR lower(x) LIKE '%hxy%' OR lower(x) LIKE 'wiko%' OR lower(x) LIKE '%wiko%' OR lower(x) LIKE 'jio%' OR lower(x) LIKE '%jio%' OR lower(x) LIKE 'itel%' OR lower(x) LIKE '%itel%' OR lower(x) LIKE '%results%' OR lower(x) RLIKE '^(smtp|api|mdm|vpn|dns|rda|uag|dc|cpms|console|wsus)\\\\\\\\d*$' OR lower(x) RLIKE '^(' || 'static(-\\\\\\\\d+(-\\\\\\\\d+)?)?' || '|host-\\\\\\\\d{2,3}' || '|h-\\\\\\\\d{2,3}' || '|\\\\\\\\d{2,3}' || '|v\\\\\\\\d{4}' || '|(mx|ns)\\\\\\\\d+' || '|tlscmx\\\\\\\\d+' || '|pw-ether\\\\\\\\d+' || '|ftp|vpn|api|dev|mail|sso|host|survey|teleperformance|pacificinterpreters|unknown|ns03|webmail|survey|languageline|static|tlscontact|travelisa|mi-bospo|autodiscover|extranet|nameless|www|deffmtpc01|teleperformance' || ')$' OR lower(x) IN ( 'portal', 'tp', 'bog', 'lap-l', '[no results]', 'host', 'console', 'mail', 'www', '192', 'static', '.', 'iphone de lenovo', 'user deleted for this device', 'apple', 'fs', 'mohamed', '(2)', '-pc', 'admin', 'desktop', 'imac', 'dell', 'localhost', 'dell-pc', 'mac', 'med', 'med-' ) ) THEN 1 WHEN EXISTS( fqdn, x -> SPLIT(x, '\\\\\\\\.') [SIZE( SPLIT(x, '\\\\\\\\.') ) - 1] RLIKE '\\\\\\\\s' OR SPLIT(x, '\\\\\\\\.') [SIZE( SPLIT(x, '\\\\\\\\.') ) - 1] RLIKE '\\\\'' OR SPLIT(x, ' \\\\\\\\.')[SIZE(SPLIT(x, ' \\\\\\\\.')) - 1] RLIKE ' ^ \\\\\\\\d + $ ' OR LENGTH(SPLIT(x, ' \\\\\\\\.')[0]) <= 2 OR LENGTH(SPLIT(x, ' \\\\\\\\.')[SIZE(SPLIT(x, ' \\\\\\\\.')) - 1]) <= 1 OR lower(SPLIT(x, ' \\\\\\\\.')[SIZE(SPLIT(x, ' \\\\\\\\.')) - 1]) IN (' lan ') ) THEN 1 WHEN EXISTS(cloud_provider_unique_id, x -> x IS NOT NULL) THEN 1 WHEN EXISTS(cloud_resource_id, x -> x IS NOT NULL) THEN 1 WHEN lower(domain) RLIKE ' ^( work | workgroup | unknown | no domain | none ) $ ' THEN 1 WHEN lower(domain) LIKE ' % error % ' OR lower(domain) LIKE ' % result % ' THEN 1 WHEN lower(os_family) IN (' ios ', ' android ') THEN 1 WHEN lower(type) = ' container ' THEN 1 WHEN MAX(last_active_date) OVER (PARTITION BY host_name, fqdn) IS NULL THEN 1 WHEN last_active_date = MAX(last_active_date) OVER (PARTITION BY host_name, fqdn) THEN 1 ELSE 0 END\"", "}"], "removed_lines": ["\"colExpr\": \"CASE WHEN EXISTS(host_name, x -> lower(x) = '*' OR lower(x) LIKE '%iphone%' OR lower(x) LIKE '%androidenterprise%' OR lower(x) LIKE '%androidforwork%' OR lower(x) LIKE '%android%' OR lower(x) LIKE '%ipad%' OR lower(x) LIKE '% ipad %' OR lower(x) LIKE '%acer%' OR lower(x) RLIKE 'macbook' OR lower(x) LIKE '%samsungsm%' OR lower(x) LIKE '%samsungsc%' OR lower(x) LIKE '%samsungsamsung%' OR lower(x) LIKE '%xiaomi%' OR lower(x) LIKE '%huawei%' OR lower(x) LIKE '%motorola%' OR lower(x) LIKE '%oppo%' OR lower(x) LIKE '%googlepixel%' OR lower(x) LIKE '%vodafone%' OR lower(x) LIKE '%oneplus%' OR lower(x) LIKE '%realme%' OR lower(x) LIKE '%honor%' OR lower(x) LIKE '%vivo%' OR lower(x) LIKE '%infinix%' OR lower(x) LIKE '%freescale%' OR lower(x) LIKE '%sony%' OR lower(x) LIKE '%tecno mobile%' OR lower(x) LIKE '%tecno%' OR lower(x) LIKE '%ipod%' OR lower(x) LIKE '%blackberry%' OR lower(x) LIKE '%tecnotecno%' OR lower(x) LIKE '%nokia%' OR lower(x) LIKE '%blackview%' OR lower(x) LIKE '%kornsifero%' OR lower(x) LIKE '%hmd global%' OR lower(x) LIKE '%hmd%' OR lower(x) LIKE '%nubia%' OR lower(x) LIKE '%general mobile%' OR lower(x) LIKE '%reeder%' OR lower(x) LIKE '%microsoft%' OR lower(x) LIKE '%polystudio%' OR lower(x) LIKE '%rockchip%' OR lower(x) LIKE '%logitech%' OR lower(x) LIKE '%cubot%' OR lower(x) LIKE '%blackshark%' OR lower(x) LIKE '%fairphone%' OR lower(x) LIKE '%wingtech%' OR lower(x) LIKE '%oukitel%' OR lower(x) LIKE '%vestelvenus%' OR lower(x) LIKE '%leiminmate%' OR lower(x) LIKE 'sharp%' OR lower(x) LIKE '%sharp%' OR lower(x) LIKE 'lenovolenovo%' OR lower(x) LIKE '%lenovolenovo%' OR lower(x) LIKE 'nothinga%' OR lower(x) LIKE '%nothinga%' OR lower(x) LIKE 'asus%' OR lower(x) LIKE '%asus%' OR lower(x) LIKE 'ipad%' OR lower(x) LIKE 'lge%' OR lower(x) LIKE '%lge%' OR lower(x) LIKE 'tcl%' OR lower(x) LIKE '%tcl%' OR lower(x) LIKE 'zte%' OR lower(x) LIKE '%zte%' OR lower(x) LIKE 'htc%' OR lower(x) LIKE '%htc%' OR lower(x) LIKE 'hxy%' OR lower(x) LIKE '%hxy%' OR lower(x) LIKE 'wiko%' OR lower(x) LIKE '%wiko%' OR lower(x) LIKE 'jio%' OR lower(x) LIKE '%jio%' OR lower(x) LIKE 'itel%' OR lower(x) LIKE '%itel%' OR lower(x) LIKE '%results%' OR lower(x) RLIKE '^(smtp|api|mdm|vpn|dns|rda|uag|dc|cpms|console|wsus)\\\\\\\\d*$' OR lower(x) RLIKE '^(' || 'static(-\\\\\\\\d+(-\\\\\\\\d+)?)?' || '|host-\\\\\\\\d{2,3}' || '|h-\\\\\\\\d{2,3}' || '|\\\\\\\\d{2,3}' || '|v\\\\\\\\d{4}' || '|(mx|ns)\\\\\\\\d+' || '|tlscmx\\\\\\\\d+' || '|pw-ether\\\\\\\\d+' || '|ftp|vpn|api|dev|mail|sso|host|survey|teleperformance|pacificinterpreters|unknown|ns03|webmail|survey|languageline|static|tlscontact|travelisa|mi-bospo|autodiscover|extranet|nameless|www|deffmtpc01|teleperformance' || ')$' OR lower(x) IN ( 'portal','tp','bog','lap-l','[no results]','host','console','mail','www', '192','static','.','iphone de lenovo','user deleted for this device','apple', 'fs','mohamed','(2)','-pc','admin','desktop','imac','dell','localhost', 'dell-pc','mac','med','med-' ) ) THEN 1 WHEN EXISTS(fqdn, x -> SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1] RLIKE '\\\\\\\\s' OR SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1] RLIKE '\\\\'' OR SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1] RLIKE '^\\\\\\\\d+$' OR LENGTH(SPLIT(x, '\\\\\\\\.')[0]) <= 2 OR LENGTH(SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1]) <= 1 OR lower(SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1]) IN ('lan') ) THEN 1 WHEN EXISTS(cloud_provider_unique_id, x -> x IS NOT NULL) THEN 1 WHEN EXISTS(cloud_resource_id, x -> x IS NOT NULL) THEN 1 WHEN lower(domain) RLIKE '^(work|workgroup|unknown|no domain|none)$' THEN 1 WHEN lower(domain) LIKE '%error%' OR lower(domain) LIKE '%result%' THEN 1 WHEN lower(os_family) IN ('ios', 'android') THEN 1 WHEN lower(type) = 'container' THEN 1 WHEN MAX(last_active_date) OVER (PARTITION BY host_name, fqdn) IS NULL THEN 1 WHEN last_active_date = MAX(last_active_date) OVER (PARTITION BY host_name, fqdn) THEN 1 ELSE 0 END AS latest_flag\"", "}"]}]}, {"summary": "The pull request modifies the `sds_ei__host__tanium__job_config.json` file to improve null handling in the Tanium data source. Specifically, it updates the `colExpr` to include a check for empty `host_name` and `fqdn` fields before applying other disambiguation rules. It also fixes a regex error and adds spaces around the dots in the fqdn split function.", "files_changed": [{"file_path": "configs/sds_ei_configs/spark_job_configs/source_models/intrasource_disambiguated_models/sds_ei__host__tanium__job_config.json", "change_type": "modified", "added_lines": ["\"colExpr\": \"CASE WHEN SIZE(host_name) < 1 AND SIZE(fqdn) < 1 THEN 1 WHEN EXISTS( host_name, x -> lower(x) = '*' OR lower(x) LIKE '%iphone%' OR lower(x) LIKE '%androidenterprise%' OR lower(x) LIKE '%androidforwork%' OR lower(x) LIKE '%android%' OR lower(x) LIKE '%ipad%' OR lower(x) LIKE '% ipad %' OR lower(x) LIKE '%acer%' OR lower(x) RLIKE 'macbook' OR lower(x) LIKE '%samsungsm%' OR lower(x) LIKE '%samsungsc%' OR lower(x) LIKE '%samsungsamsung%' OR lower(x) LIKE '%xiaomi%' OR lower(x) LIKE '%huawei%' OR lower(x) LIKE '%motorola%' OR lower(x) LIKE '%oppo%' OR lower(x) LIKE '%googlepixel%' OR lower(x) LIKE '%vodafone%' OR lower(x) LIKE '%oneplus%' OR lower(x) LIKE '%realme%' OR lower(x) LIKE '%honor%' OR lower(x) LIKE '%vivo%' OR lower(x) LIKE '%infinix%' OR lower(x) LIKE '%freescale%' OR lower(x) LIKE '%sony%' OR lower(x) LIKE '%tecno mobile%' OR lower(x) LIKE '%tecno%' OR lower(x) LIKE '%ipod%' OR lower(x) LIKE '%blackberry%' OR lower(x) LIKE '%tecnotecno%' OR lower(x) LIKE '%nokia%' OR lower(x) LIKE '%blackview%' OR lower(x) LIKE '%kornsifero%' OR lower(x) LIKE '%hmd global%' OR lower(x) LIKE '%hmd%' OR lower(x) LIKE '%nubia%' OR lower(x) LIKE '%general mobile%' OR lower(x) LIKE '%reeder%' OR lower(x) LIKE '%microsoft%' OR lower(x) LIKE '%polystudio%' OR lower(x) LIKE '%rockchip%' OR lower(x) LIKE '%logitech%' OR lower(x) LIKE '%cubot%' OR lower(x) LIKE '%blackshark%' OR lower(x) LIKE '%fairphone%' OR lower(x) LIKE '%wingtech%' OR lower(x) LIKE '%oukitel%' OR lower(x) LIKE '%vestelvenus%' OR lower(x) LIKE '%leiminmate%' OR lower(x) LIKE 'sharp%' OR lower(x) LIKE '%sharp%' OR lower(x) LIKE 'lenovolenovo%' OR lower(x) LIKE '%lenovolenovo%' OR lower(x) LIKE 'nothinga%' OR lower(x) LIKE '%nothinga%' OR lower(x) LIKE 'asus%' OR lower(x) LIKE '%asus%' OR lower(x) LIKE 'ipad%' OR lower(x) LIKE 'lge%' OR lower(x) LIKE '%lge%' OR lower(x) LIKE 'tcl%' OR lower(x) LIKE '%tcl%' OR lower(x) LIKE 'zte%' OR lower(x) LIKE '%zte%' OR lower(x) LIKE 'htc%' OR lower(x) LIKE '%htc%' OR lower(x) LIKE 'hxy%' OR lower(x) LIKE '%hxy%' OR lower(x) LIKE 'wiko%' OR lower(x) LIKE '%wiko%' OR lower(x) LIKE 'jio%' OR lower(x) LIKE '%jio%' OR lower(x) LIKE 'itel%' OR lower(x) LIKE '%itel%' OR lower(x) LIKE '%results%' OR lower(x) RLIKE '^(smtp|api|mdm|vpn|dns|rda|uag|dc|cpms|console|wsus)\\\\\\\\d*$' OR lower(x) RLIKE '^(' || 'static(-\\\\\\\\d+(-\\\\\\\\d+)?)?' || '|host-\\\\\\\\d{2,3}' || '|h-\\\\\\\\d{2,3}' || '|\\\\\\\\d{2,3}' || '|v\\\\\\\\d{4}' || '|(mx|ns)\\\\\\\\d+' || '|tlscmx\\\\\\\\d+' || '|pw-ether\\\\\\\\d+' || '|ftp|vpn|api|dev|mail|sso|host|survey|teleperformance|pacificinterpreters|unknown|ns03|webmail|survey|languageline|static|tlscontact|travelisa|mi-bospo|autodiscover|extranet|nameless|www|deffmtpc01|teleperformance' || ')$' OR lower(x) IN ( 'portal', 'tp', 'bog', 'lap-l', '[no results]', 'host', 'console', 'mail', 'www', '192', 'static', '.', 'iphone de lenovo', 'user deleted for this device', 'apple', 'fs', 'mohamed', '(2)', '-pc', 'admin', 'desktop', 'imac', 'dell', 'localhost', 'dell-pc', 'mac', 'med', 'med-' ) ) THEN 1 WHEN EXISTS( fqdn, x -> SPLIT(x, '\\\\\\\\.') [SIZE( SPLIT(x, '\\\\\\\\.') ) - 1] RLIKE '\\\\\\\\s' OR SPLIT(x, '\\\\\\\\.') [SIZE( SPLIT(x, '\\\\\\\\.') ) - 1] RLIKE '\\\\'' OR SPLIT(x, ' \\\\\\\\.')[SIZE(SPLIT(x, ' \\\\\\\\.')) - 1] RLIKE ' ^ \\\\\\\\d + $ ' OR LENGTH(SPLIT(x, ' \\\\\\\\.')[0]) <= 2 OR LENGTH(SPLIT(x, ' \\\\\\\\.')[SIZE(SPLIT(x, ' \\\\\\\\.')) - 1]) <= 1 OR lower(SPLIT(x, ' \\\\\\\\.')[SIZE(SPLIT(x, ' \\\\\\\\.')) - 1]) IN (' lan ') ) THEN 1 WHEN EXISTS(cloud_provider_unique_id, x -> x IS NOT NULL) THEN 1 WHEN EXISTS(cloud_resource_id, x -> x IS NOT NULL) THEN 1 WHEN lower(domain) RLIKE ' ^( work | workgroup | unknown | no domain | none ) $ ' THEN 1 WHEN lower(domain) LIKE ' % error % ' OR lower(domain) LIKE ' % result % ' THEN 1 WHEN lower(os_family) IN (' ios ', ' android ') THEN 1 WHEN lower(type) = ' container ' THEN 1 WHEN MAX(last_active_date) OVER (PARTITION BY host_name, fqdn) IS NULL THEN 1 WHEN last_active_date = MAX(last_active_date) OVER (PARTITION BY host_name, fqdn) THEN 1 ELSE 0 END\"", "}"], "removed_lines": ["\"colExpr\": \"CASE WHEN EXISTS(host_name, x -> lower(x) = '*' OR lower(x) LIKE '%iphone%' OR lower(x) LIKE '%androidenterprise%' OR lower(x) LIKE '%androidforwork%' OR lower(x) LIKE '%android%' OR lower(x) LIKE '%ipad%' OR lower(x) LIKE '% ipad %' OR lower(x) LIKE '%acer%' OR lower(x) RLIKE 'macbook' OR lower(x) LIKE '%samsungsm%' OR lower(x) LIKE '%samsungsc%' OR lower(x) LIKE '%samsungsamsung%' OR lower(x) LIKE '%xiaomi%' OR lower(x) LIKE '%huawei%' OR lower(x) LIKE '%motorola%' OR lower(x) LIKE '%oppo%' OR lower(x) LIKE '%googlepixel%' OR lower(x) LIKE '%vodafone%' OR lower(x) LIKE '%oneplus%' OR lower(x) LIKE '%realme%' OR lower(x) LIKE '%honor%' OR lower(x) LIKE '%vivo%' OR lower(x) LIKE '%infinix%' OR lower(x) LIKE '%freescale%' OR lower(x) LIKE '%sony%' OR lower(x) LIKE '%tecno mobile%' OR lower(x) LIKE '%tecno%' OR lower(x) LIKE '%ipod%' OR lower(x) LIKE '%blackberry%' OR lower(x) LIKE '%tecnotecno%' OR lower(x) LIKE '%nokia%' OR lower(x) LIKE '%blackview%' OR lower(x) LIKE '%kornsifero%' OR lower(x) LIKE '%hmd global%' OR lower(x) LIKE '%hmd%' OR lower(x) LIKE '%nubia%' OR lower(x) LIKE '%general mobile%' OR lower(x) LIKE '%reeder%' OR lower(x) LIKE '%microsoft%' OR lower(x) LIKE '%polystudio%' OR lower(x) LIKE '%rockchip%' OR lower(x) LIKE '%logitech%' OR lower(x) LIKE '%cubot%' OR lower(x) LIKE '%blackshark%' OR lower(x) LIKE '%fairphone%' OR lower(x) LIKE '%wingtech%' OR lower(x) LIKE '%oukitel%' OR lower(x) LIKE '%vestelvenus%' OR lower(x) LIKE '%leiminmate%' OR lower(x) LIKE 'sharp%' OR lower(x) LIKE '%sharp%' OR lower(x) LIKE 'lenovolenovo%' OR lower(x) LIKE '%lenovolenovo%' OR lower(x) LIKE 'nothinga%' OR lower(x) LIKE '%nothinga%' OR lower(x) LIKE 'asus%' OR lower(x) LIKE '%asus%' OR lower(x) LIKE 'ipad%' OR lower(x) LIKE 'lge%' OR lower(x) LIKE '%lge%' OR lower(x) LIKE 'tcl%' OR lower(x) LIKE '%tcl%' OR lower(x) LIKE 'zte%' OR lower(x) LIKE '%zte%' OR lower(x) LIKE 'htc%' OR lower(x) LIKE '%htc%' OR lower(x) LIKE 'hxy%' OR lower(x) LIKE '%hxy%' OR lower(x) LIKE 'wiko%' OR lower(x) LIKE '%wiko%' OR lower(x) LIKE 'jio%' OR lower(x) LIKE '%jio%' OR lower(x) LIKE 'itel%' OR lower(x) LIKE '%itel%' OR lower(x) LIKE '%results%' OR lower(x) RLIKE '^(smtp|api|mdm|vpn|dns|rda|uag|dc|cpms|console|wsus)\\\\\\\\d*$' OR lower(x) RLIKE '^(' || 'static(-\\\\\\\\d+(-\\\\\\\\d+)?)?' || '|host-\\\\\\\\d{2,3}' || '|h-\\\\\\\\d{2,3}' || '|\\\\\\\\d{2,3}' || '|v\\\\\\\\d{4}' || '|(mx|ns)\\\\\\\\d+' || '|tlscmx\\\\\\\\d+' || '|pw-ether\\\\\\\\d+' || '|ftp|vpn|api|dev|mail|sso|host|survey|teleperformance|pacificinterpreters|unknown|ns03|webmail|survey|languageline|static|tlscontact|travelisa|mi-bospo|autodiscover|extranet|nameless|www|deffmtpc01|teleperformance' || ')$' OR lower(x) IN ( 'portal','tp','bog','lap-l','[no results]','host','console','mail','www', '192','static','.','iphone de lenovo','user deleted for this device','apple', 'fs','mohamed','(2)','-pc','admin','desktop','imac','dell','localhost', 'dell-pc','mac','med','med-' ) ) THEN 1 WHEN EXISTS(fqdn, x -> SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1] RLIKE '\\\\\\\\s' OR SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1] RLIKE '\\\\'' OR SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1] RLIKE '^\\\\\\\\d+$' OR LENGTH(SPLIT(x, '\\\\\\\\.')[0]) <= 2 OR LENGTH(SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1]) <= 1 OR lower(SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1]) IN ('lan') ) THEN 1 WHEN EXISTS(cloud_provider_unique_id, x -> x IS NOT NULL) THEN 1 WHEN EXISTS(cloud_resource_id, x -> x IS NOT NULL) THEN 1 WHEN lower(domain) RLIKE '^(work|workgroup|unknown|no domain|none)$' THEN 1 WHEN lower(domain) LIKE '%error%' OR lower(domain) LIKE '%result%' THEN 1 WHEN lower(os_family) IN ('ios', 'android') THEN 1 WHEN lower(type) = 'container' THEN 1 WHEN MAX(last_active_date) OVER (PARTITION BY host_name, fqdn) IS NULL THEN 1 WHEN last_active_date = MAX(last_active_date) OVER (PARTITION BY host_name, fqdn) THEN 1 ELSE 0 END AS latest_flag\"", "}"]}]}, {"summary": "This pull request modifies the `sds_ei__host__tenable_io__job_config.json` file to improve null handling in the Tenable.io data source. Specifically, it updates a complex `colExpr` to include a check for empty `host_name` and `fqdn` lists before applying existing logic. It also adds spaces around the values in the `os_family` IN clause, and adds a check for when the `last_active_date` is null.", "files_changed": [{"file_path": "configs/sds_ei_configs/spark_job_configs/source_models/intrasource_disambiguated_models/sds_ei__host__tenable_io__job_config.json", "change_type": "modified", "added_lines": ["\"colExpr\": \"CASE WHEN SIZE(host_name) < 1 AND SIZE(fqdn) < 1 THEN 1 WHEN EXISTS( host_name, x -> lower(x) = '*' OR lower(x) LIKE '%iphone%' OR lower(x) LIKE '%androidenterprise%' OR lower(x) LIKE '%androidforwork%' OR lower(x) LIKE '%android%' OR lower(x) LIKE '%ipad%' OR lower(x) LIKE '% ipad %' OR lower(x) LIKE '%acer%' OR lower(x) RLIKE 'macbook' OR lower(x) LIKE '%samsungsm%' OR lower(x) LIKE '%samsungsc%' OR lower(x) LIKE '%samsungsamsung%' OR lower(x) LIKE '%xiaomi%' OR lower(x) LIKE '%huawei%' OR lower(x) LIKE '%motorola%' OR lower(x) LIKE '%oppo%' OR lower(x) LIKE '%googlepixel%' OR lower(x) LIKE '%vodafone%' OR lower(x) LIKE '%oneplus%' OR lower(x) LIKE '%realme%' OR lower(x) LIKE '%honor%' OR lower(x) LIKE '%vivo%' OR lower(x) LIKE '%infinix%' OR lower(x) LIKE '%freescale%' OR lower(x) LIKE '%sony%' OR lower(x) LIKE '%tecno mobile%' OR lower(x) LIKE '%tecno%' OR lower(x) LIKE '%ipod%' OR lower(x) LIKE '%blackberry%' OR lower(x) LIKE '%tecnotecno%' OR lower(x) LIKE '%nokia%' OR lower(x) LIKE '%blackview%' OR lower(x) LIKE '%kornsifero%' OR lower(x) LIKE '%hmd global%' OR lower(x) LIKE '%hmd%' OR lower(x) LIKE '%nubia%' OR lower(x) LIKE '%general mobile%' OR lower(x) LIKE '%reeder%' OR lower(x) LIKE '%microsoft%' OR lower(x) LIKE '%polystudio%' OR lower(x) LIKE '%rockchip%' OR lower(x) LIKE '%logitech%' OR lower(x) LIKE '%cubot%' OR lower(x) LIKE '%blackshark%' OR lower(x) LIKE '%fairphone%' OR lower(x) LIKE '%wingtech%' OR lower(x) LIKE '%oukitel%' OR lower(x) LIKE '%vestelvenus%' OR lower(x) LIKE '%leiminmate%' OR lower(x) LIKE 'sharp%' OR lower(x) LIKE '%sharp%' OR lower(x) LIKE 'lenovolenovo%' OR lower(x) LIKE '%lenovolenovo%' OR lower(x) LIKE 'nothinga%' OR lower(x) LIKE '%nothinga%' OR lower(x) LIKE 'asus%' OR lower(x) LIKE '%asus%' OR lower(x) LIKE 'ipad%' OR lower(x) LIKE 'lge%' OR lower(x) LIKE '%lge%' OR lower(x) LIKE 'tcl%' OR lower(x) LIKE '%tcl%' OR lower(x) LIKE 'zte%' OR lower(x) LIKE '%zte%' OR lower(x) LIKE 'htc%' OR lower(x) LIKE '%htc%' OR lower(x) LIKE 'hxy%' OR lower(x) LIKE '%hxy%' OR lower(x) LIKE 'wiko%' OR lower(x) LIKE '%wiko%' OR lower(x) LIKE 'jio%' OR lower(x) LIKE '%jio%' OR lower(x) LIKE 'itel%' OR lower(x) LIKE '%itel%' OR lower(x) LIKE '%results%' OR lower(x) RLIKE '^(smtp|api|mdm|vpn|dns|rda|uag|dc|cpms|console|wsus)\\\\\\\\d*$' OR lower(x) RLIKE '^(' || 'static(-\\\\\\\\d+(-\\\\\\\\d+)?)?' || '|host-\\\\\\\\d{2,3}' || '|h-\\\\\\\\d{2,3}' || '|\\\\\\\\d{2,3}' || '|v\\\\\\\\d{4}' || '|(mx|ns)\\\\\\\\d+' || '|tlscmx\\\\\\\\d+' || '|pw-ether\\\\\\\\d+' || '|ftp|vpn|api|dev|mail|sso|host|survey|teleperformance|pacificinterpreters|unknown|ns03|webmail|survey|languageline|static|tlscontact|travelisa|mi-bospo|autodiscover|extranet|nameless|www|deffmtpc01|teleperformance' || ')$' OR lower(x) IN ( 'portal', 'tp', 'bog', 'lap-l', '[no results]', 'host', 'console', 'mail', 'www', '192', 'static', '.', 'iphone de lenovo', 'user deleted for this device', 'apple', 'fs', 'mohamed', '(2)', '-pc', 'admin', 'desktop', 'imac', 'dell', 'localhost', 'dell-pc', 'mac', 'med', 'med-' ) ) THEN 1 WHEN EXISTS( fqdn, x -> SPLIT(x, '\\\\\\\\.') [SIZE( SPLIT(x, '\\\\\\\\.') ) - 1] RLIKE '\\\\\\\\s' OR SPLIT(x, '\\\\\\\\.') [SIZE( SPLIT(x, '\\\\\\\\.') ) - 1] RLIKE '\\\\'' OR SPLIT(x, ' \\\\\\\\.')[SIZE(SPLIT(x, ' \\\\\\\\.')) - 1] RLIKE ' ^ \\\\\\\\d + $ ' OR LENGTH(SPLIT(x, ' \\\\\\\\.')[0]) <= 2 OR LENGTH(SPLIT(x, ' \\\\\\\\.')[SIZE(SPLIT(x, ' \\\\\\\\.')) - 1]) <= 1 OR lower(SPLIT(x, ' \\\\\\\\.')[SIZE(SPLIT(x, ' \\\\\\\\.')) - 1]) IN (' lan ') ) THEN 1 WHEN EXISTS(cloud_provider_unique_id, x -> x IS NOT NULL) THEN 1 WHEN EXISTS(cloud_resource_id, x -> x IS NOT NULL) THEN 1 WHEN lower(domain) RLIKE ' ^( work | workgroup | unknown | no domain | none ) $ ' THEN 1 WHEN lower(domain) LIKE ' % error % ' OR lower(domain) LIKE ' % result % ' THEN 1 WHEN lower(os_family) IN (' ios ', ' android ') THEN 1 WHEN lower(type) = ' container ' THEN 1 WHEN MAX(last_active_date) OVER (PARTITION BY host_name, fqdn) IS NULL THEN 1 WHEN last_active_date = MAX(last_active_date) OVER (PARTITION BY host_name, fqdn) THEN 1 ELSE 0 END\"", "}"], "removed_lines": ["\"colExpr\": \"CASE WHEN EXISTS(host_name, x -> lower(x) = '*' OR lower(x) LIKE '%iphone%' OR lower(x) LIKE '%androidenterprise%' OR lower(x) LIKE '%androidforwork%' OR lower(x) LIKE '%android%' OR lower(x) LIKE '%ipad%' OR lower(x) LIKE '% ipad %' OR lower(x) LIKE '%acer%' OR lower(x) RLIKE 'macbook' OR lower(x) LIKE '%samsungsm%' OR lower(x) LIKE '%samsungsc%' OR lower(x) LIKE '%samsungsamsung%' OR lower(x) LIKE '%xiaomi%' OR lower(x) LIKE '%huawei%' OR lower(x) LIKE '%motorola%' OR lower(x) LIKE '%oppo%' OR lower(x) LIKE '%googlepixel%' OR lower(x) LIKE '%vodafone%' OR lower(x) LIKE '%oneplus%' OR lower(x) LIKE '%realme%' OR lower(x) LIKE '%honor%' OR lower(x) LIKE '%vivo%' OR lower(x) LIKE '%infinix%' OR lower(x) LIKE '%freescale%' OR lower(x) LIKE '%sony%' OR lower(x) LIKE '%tecno mobile%' OR lower(x) LIKE '%tecno%' OR lower(x) LIKE '%ipod%' OR lower(x) LIKE '%blackberry%' OR lower(x) LIKE '%tecnotecno%' OR lower(x) LIKE '%nokia%' OR lower(x) LIKE '%blackview%' OR lower(x) LIKE '%kornsifero%' OR lower(x) LIKE '%hmd global%' OR lower(x) LIKE '%hmd%' OR lower(x) LIKE '%nubia%' OR lower(x) LIKE '%general mobile%' OR lower(x) LIKE '%reeder%' OR lower(x) LIKE '%microsoft%' OR lower(x) LIKE '%polystudio%' OR lower(x) LIKE '%rockchip%' OR lower(x) LIKE '%logitech%' OR lower(x) LIKE '%cubot%' OR lower(x) LIKE '%blackshark%' OR lower(x) LIKE '%fairphone%' OR lower(x) LIKE '%wingtech%' OR lower(x) LIKE '%oukitel%' OR lower(x) LIKE '%vestelvenus%' OR lower(x) LIKE '%leiminmate%' OR lower(x) LIKE 'sharp%' OR lower(x) LIKE '%sharp%' OR lower(x) LIKE 'lenovolenovo%' OR lower(x) LIKE '%lenovolenovo%' OR lower(x) LIKE 'nothinga%' OR lower(x) LIKE '%nothinga%' OR lower(x) LIKE 'asus%' OR lower(x) LIKE '%asus%' OR lower(x) LIKE 'ipad%' OR lower(x) LIKE 'lge%' OR lower(x) LIKE '%lge%' OR lower(x) LIKE 'tcl%' OR lower(x) LIKE '%tcl%' OR lower(x) LIKE 'zte%' OR lower(x) LIKE '%zte%' OR lower(x) LIKE 'htc%' OR lower(x) LIKE '%htc%' OR lower(x) LIKE 'hxy%' OR lower(x) LIKE '%hxy%' OR lower(x) LIKE 'wiko%' OR lower(x) LIKE '%wiko%' OR lower(x) LIKE 'jio%' OR lower(x) LIKE '%jio%' OR lower(x) LIKE 'itel%' OR lower(x) LIKE '%itel%' OR lower(x) LIKE '%results%' OR lower(x) RLIKE '^(smtp|api|mdm|vpn|dns|rda|uag|dc|cpms|console|wsus)\\\\\\\\d*$' OR lower(x) RLIKE '^(' || 'static(-\\\\\\\\d+(-\\\\\\\\d+)?)?' || '|host-\\\\\\\\d{2,3}' || '|h-\\\\\\\\d{2,3}' || '|\\\\\\\\d{2,3}' || '|v\\\\\\\\d{4}' || '|(mx|ns)\\\\\\\\d+' || '|tlscmx\\\\\\\\d+' || '|pw-ether\\\\\\\\d+' || '|ftp|vpn|api|dev|mail|sso|host|survey|teleperformance|pacificinterpreters|unknown|ns03|webmail|survey|languageline|static|tlscontact|travelisa|mi-bospo|autodiscover|extranet|nameless|www|deffmtpc01|teleperformance' || ')$' OR lower(x) IN ( 'portal','tp','bog','lap-l','[no results]','host','console','mail','www', '192','static','.','iphone de lenovo','user deleted for this device','apple', 'fs','mohamed','(2)','-pc','admin','desktop','imac','dell','localhost', 'dell-pc','mac','med','med-' ) ) THEN 1 WHEN EXISTS(fqdn, x -> SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1] RLIKE '\\\\\\\\s' OR SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1] RLIKE '\\\\'' OR SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1] RLIKE '^\\\\\\\\d+$' OR LENGTH(SPLIT(x, '\\\\\\\\.')[0]) <= 2 OR LENGTH(SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1]) <= 1 OR lower(SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1]) IN ('lan') ) THEN 1 WHEN EXISTS(cloud_provider_unique_id, x -> x IS NOT NULL) THEN 1 WHEN EXISTS(cloud_resource_id, x -> x IS NOT NULL) THEN 1 WHEN lower(domain) RLIKE '^(work|workgroup|unknown|no domain|none)$' THEN 1 WHEN lower(domain) LIKE '%error%' OR lower(domain) LIKE '%result%' THEN 1 WHEN lower(os_family) IN ('ios', 'android') THEN 1 WHEN lower(type) = 'container' THEN 1 WHEN MAX(last_active_date) OVER (PARTITION BY host_name, fqdn) IS NULL THEN 1 WHEN last_active_date = MAX(last_active_date) OVER (PARTITION BY host_name, fqdn) THEN 1 ELSE 0 END AS latest_flag\"", "}"]}]}, {"summary": "The pull request modifies the `sds_ei__host__wiz__job_config.json` file to improve null handling in the WIZ data source. Specifically, it updates the `colExpr` to include a check for empty `host_name` and `fqdn` arrays before applying the existing logic for identifying non-standard hostnames. It also removes the alias `AS latest_flag` from the end of the expression.", "files_changed": [{"file_path": "configs/sds_ei_configs/spark_job_configs/source_models/intrasource_disambiguated_models/sds_ei__host__wiz__job_config.json", "change_type": "modified", "added_lines": ["\"colExpr\": \"CASE WHEN SIZE(host_name) < 1 AND SIZE(fqdn) < 1 THEN 1 WHEN EXISTS( host_name, x -> lower(x) = '*' OR lower(x) LIKE '%iphone%' OR lower(x) LIKE '%androidenterprise%' OR lower(x) LIKE '%androidforwork%' OR lower(x) LIKE '%android%' OR lower(x) LIKE '%ipad%' OR lower(x) LIKE '% ipad %' OR lower(x) LIKE '%acer%' OR lower(x) RLIKE 'macbook' OR lower(x) LIKE '%samsungsm%' OR lower(x) LIKE '%samsungsc%' OR lower(x) LIKE '%samsungsamsung%' OR lower(x) LIKE '%xiaomi%' OR lower(x) LIKE '%huawei%' OR lower(x) LIKE '%motorola%' OR lower(x) LIKE '%oppo%' OR lower(x) LIKE '%googlepixel%' OR lower(x) LIKE '%vodafone%' OR lower(x) LIKE '%oneplus%' OR lower(x) LIKE '%realme%' OR lower(x) LIKE '%honor%' OR lower(x) LIKE '%vivo%' OR lower(x) LIKE '%infinix%' OR lower(x) LIKE '%freescale%' OR lower(x) LIKE '%sony%' OR lower(x) LIKE '%tecno mobile%' OR lower(x) LIKE '%tecno%' OR lower(x) LIKE '%ipod%' OR lower(x) LIKE '%blackberry%' OR lower(x) LIKE '%tecnotecno%' OR lower(x) LIKE '%nokia%' OR lower(x) LIKE '%blackview%' OR lower(x) LIKE '%kornsifero%' OR lower(x) LIKE '%hmd global%' OR lower(x) LIKE '%hmd%' OR lower(x) LIKE '%nubia%' OR lower(x) LIKE '%general mobile%' OR lower(x) LIKE '%reeder%' OR lower(x) LIKE '%microsoft%' OR lower(x) LIKE '%polystudio%' OR lower(x) LIKE '%rockchip%' OR lower(x) LIKE '%logitech%' OR lower(x) LIKE '%cubot%' OR lower(x) LIKE '%blackshark%' OR lower(x) LIKE '%fairphone%' OR lower(x) LIKE '%wingtech%' OR lower(x) LIKE '%oukitel%' OR lower(x) LIKE '%vestelvenus%' OR lower(x) LIKE '%leiminmate%' OR lower(x) LIKE 'sharp%' OR lower(x) LIKE '%sharp%' OR lower(x) LIKE 'lenovolenovo%' OR lower(x) LIKE '%lenovolenovo%' OR lower(x) LIKE 'nothinga%' OR lower(x) LIKE '%nothinga%' OR lower(x) LIKE 'asus%' OR lower(x) LIKE '%asus%' OR lower(x) LIKE 'ipad%' OR lower(x) LIKE 'lge%' OR lower(x) LIKE '%lge%' OR lower(x) LIKE 'tcl%' OR lower(x) LIKE '%tcl%' OR lower(x) LIKE 'zte%' OR lower(x) LIKE '%zte%' OR lower(x) LIKE 'htc%' OR lower(x) LIKE '%htc%' OR lower(x) LIKE 'hxy%' OR lower(x) LIKE '%hxy%' OR lower(x) LIKE 'wiko%' OR lower(x) LIKE '%wiko%' OR lower(x) LIKE 'jio%' OR lower(x) LIKE '%jio%' OR lower(x) LIKE 'itel%' OR lower(x) LIKE '%itel%' OR lower(x) LIKE '%results%' OR lower(x) RLIKE '^(smtp|api|mdm|vpn|dns|rda|uag|dc|cpms|console|wsus)\\\\\\\\d*$' OR lower(x) RLIKE '^(' || 'static(-\\\\\\\\d+(-\\\\\\\\d+)?)?' || '|host-\\\\\\\\d{2,3}' || '|h-\\\\\\\\d{2,3}' || '|\\\\\\\\d{2,3}' || '|v\\\\\\\\d{4}' || '|(mx|ns)\\\\\\\\d+' || '|tlscmx\\\\\\\\d+' || '|pw-ether\\\\\\\\d+' || '|ftp|vpn|api|dev|mail|sso|host|survey|teleperformance|pacificinterpreters|unknown|ns03|webmail|survey|languageline|static|tlscontact|travelisa|mi-bospo|autodiscover|extranet|nameless|www|deffmtpc01|teleperformance' || ')$' OR lower(x) IN ( 'portal', 'tp', 'bog', 'lap-l', '[no results]', 'host', 'console', 'mail', 'www', '192', 'static', '.', 'iphone de lenovo', 'user deleted for this device', 'apple', 'fs', 'mohamed', '(2)', '-pc', 'admin', 'desktop', 'imac', 'dell', 'localhost', 'dell-pc', 'mac', 'med', 'med-' ) ) THEN 1 WHEN EXISTS( fqdn, x -> SPLIT(x, '\\\\\\\\.') [SIZE( SPLIT(x, '\\\\\\\\.') ) - 1] RLIKE '\\\\\\\\s' OR SPLIT(x, '\\\\\\\\.') [SIZE( SPLIT(x, '\\\\\\\\.') ) - 1] RLIKE '\\\\'' OR SPLIT(x, ' \\\\\\\\.')[SIZE(SPLIT(x, ' \\\\\\\\.')) - 1] RLIKE ' ^ \\\\\\\\d + $ ' OR LENGTH(SPLIT(x, ' \\\\\\\\.')[0]) <= 2 OR LENGTH(SPLIT(x, ' \\\\\\\\.')[SIZE(SPLIT(x, ' \\\\\\\\.')) - 1]) <= 1 OR lower(SPLIT(x, ' \\\\\\\\.')[SIZE(SPLIT(x, ' \\\\\\\\.')) - 1]) IN (' lan ') ) THEN 1 WHEN EXISTS(cloud_provider_unique_id, x -> x IS NOT NULL) THEN 1 WHEN EXISTS(cloud_resource_id, x -> x IS NOT NULL) THEN 1 WHEN lower(domain) RLIKE ' ^( work | workgroup | unknown | no domain | none ) $ ' THEN 1 WHEN lower(domain) LIKE ' % error % ' OR lower(domain) LIKE ' % result % ' THEN 1 WHEN lower(os_family) IN (' ios ', ' android ') THEN 1 WHEN lower(type) = ' container ' THEN 1 WHEN MAX(last_active_date) OVER (PARTITION BY host_name, fqdn) IS NULL THEN 1 WHEN last_active_date = MAX(last_active_date) OVER (PARTITION BY host_name, fqdn) THEN 1 ELSE 0 END\"", "}"], "removed_lines": ["\"colExpr\": \"CASE WHEN EXISTS(host_name, x -> lower(x) = '*' OR lower(x) LIKE '%iphone%' OR lower(x) LIKE '%androidenterprise%' OR lower(x) LIKE '%androidforwork%' OR lower(x) LIKE '%android%' OR lower(x) LIKE '%ipad%' OR lower(x) LIKE '% ipad %' OR lower(x) LIKE '%acer%' OR lower(x) RLIKE 'macbook' OR lower(x) LIKE '%samsungsm%' OR lower(x) LIKE '%samsungsc%' OR lower(x) LIKE '%samsungsamsung%' OR lower(x) LIKE '%xiaomi%' OR lower(x) LIKE '%huawei%' OR lower(x) LIKE '%motorola%' OR lower(x) LIKE '%oppo%' OR lower(x) LIKE '%googlepixel%' OR lower(x) LIKE '%vodafone%' OR lower(x) LIKE '%oneplus%' OR lower(x) LIKE '%realme%' OR lower(x) LIKE '%honor%' OR lower(x) LIKE '%vivo%' OR lower(x) LIKE '%infinix%' OR lower(x) LIKE '%freescale%' OR lower(x) LIKE '%sony%' OR lower(x) LIKE '%tecno mobile%' OR lower(x) LIKE '%tecno%' OR lower(x) LIKE '%ipod%' OR lower(x) LIKE '%blackberry%' OR lower(x) LIKE '%tecnotecno%' OR lower(x) LIKE '%nokia%' OR lower(x) LIKE '%blackview%' OR lower(x) LIKE '%kornsifero%' OR lower(x) LIKE '%hmd global%' OR lower(x) LIKE '%hmd%' OR lower(x) LIKE '%nubia%' OR lower(x) LIKE '%general mobile%' OR lower(x) LIKE '%reeder%' OR lower(x) LIKE '%microsoft%' OR lower(x) LIKE '%polystudio%' OR lower(x) LIKE '%rockchip%' OR lower(x) LIKE '%logitech%' OR lower(x) LIKE '%cubot%' OR lower(x) LIKE '%blackshark%' OR lower(x) LIKE '%fairphone%' OR lower(x) LIKE '%wingtech%' OR lower(x) LIKE '%oukitel%' OR lower(x) LIKE '%vestelvenus%' OR lower(x) LIKE '%leiminmate%' OR lower(x) LIKE 'sharp%' OR lower(x) LIKE '%sharp%' OR lower(x) LIKE 'lenovolenovo%' OR lower(x) LIKE '%lenovolenovo%' OR lower(x) LIKE 'nothinga%' OR lower(x) LIKE '%nothinga%' OR lower(x) LIKE 'asus%' OR lower(x) LIKE '%asus%' OR lower(x) LIKE 'ipad%' OR lower(x) LIKE 'lge%' OR lower(x) LIKE '%lge%' OR lower(x) LIKE 'tcl%' OR lower(x) LIKE '%tcl%' OR lower(x) LIKE 'zte%' OR lower(x) LIKE '%zte%' OR lower(x) LIKE 'htc%' OR lower(x) LIKE '%htc%' OR lower(x) LIKE 'hxy%' OR lower(x) LIKE '%hxy%' OR lower(x) LIKE 'wiko%' OR lower(x) LIKE '%wiko%' OR lower(x) LIKE 'jio%' OR lower(x) LIKE '%jio%' OR lower(x) LIKE 'itel%' OR lower(x) LIKE '%itel%' OR lower(x) LIKE '%results%' OR lower(x) RLIKE '^(smtp|api|mdm|vpn|dns|rda|uag|dc|cpms|console|wsus)\\\\\\\\d*$' OR lower(x) RLIKE '^(' || 'static(-\\\\\\\\d+(-\\\\\\\\d+)?)?' || '|host-\\\\\\\\d{2,3}' || '|h-\\\\\\\\d{2,3}' || '|\\\\\\\\d{2,3}' || '|v\\\\\\\\d{4}' || '|(mx|ns)\\\\\\\\d+' || '|tlscmx\\\\\\\\d+' || '|pw-ether\\\\\\\\d+' || '|ftp|vpn|api|dev|mail|sso|host|survey|teleperformance|pacificinterpreters|unknown|ns03|webmail|survey|languageline|static|tlscontact|travelisa|mi-bospo|autodiscover|extranet|nameless|www|deffmtpc01|teleperformance' || ')$' OR lower(x) IN ( 'portal','tp','bog','lap-l','[no results]','host','console','mail','www', '192','static','.','iphone de lenovo','user deleted for this device','apple', 'fs','mohamed','(2)','-pc','admin','desktop','imac','dell','localhost', 'dell-pc','mac','med','med-' ) ) THEN 1 WHEN EXISTS(fqdn, x -> SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1] RLIKE '\\\\\\\\s' OR SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1] RLIKE '\\\\'' OR SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1] RLIKE '^\\\\\\\\d+$' OR LENGTH(SPLIT(x, '\\\\\\\\.')[0]) <= 2 OR LENGTH(SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1]) <= 1 OR lower(SPLIT(x, '\\\\\\\\.')[SIZE(SPLIT(x, '\\\\\\\\.')) - 1]) IN ('lan') ) THEN 1 WHEN EXISTS(cloud_provider_unique_id, x -> x IS NOT NULL) THEN 1 WHEN EXISTS(cloud_resource_id, x -> x IS NOT NULL) THEN 1 WHEN lower(domain) RLIKE '^(work|workgroup|unknown|no domain|none)$' THEN 1 WHEN lower(domain) LIKE '%error%' OR lower(domain) LIKE '%result%' THEN 1 WHEN lower(os_family) IN ('ios', 'android') THEN 1 WHEN lower(type) = 'container' THEN 1 WHEN MAX(last_active_date) OVER (PARTITION BY host_name, fqdn) IS NULL THEN 1 WHEN last_active_date = MAX(last_active_date) OVER (PARTITION BY host_name, fqdn) THEN 1 ELSE 0 END AS latest_flag\"", "}"]}]}]}}